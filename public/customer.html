<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é¡§å®¢ç®¡ç† - RentPipe</title>
    <link rel="stylesheet" href="css/main.css">
    <style>
        .customer-container {
            padding: 20px;
            max-width: 1200px;
            margin: 60px auto 0;
        }

        .customer-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 30px;
            padding: 20px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .customer-actions {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .search-container {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            padding: 20px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            flex-wrap: wrap;
        }

        .search-input {
            flex: 1;
            min-width: 200px;
            padding: 12px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 16px;
        }

        .customer-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .customer-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            cursor: pointer;
            border: 2px solid transparent;
        }

        .customer-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
            border-color: #3b82f6;
        }

        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }
    </style>
</head>
<body>
    <div class="customer-container">
        <div class="customer-header">
            <div>
                <h1>é¡§å®¢ç®¡ç†</h1>
                <p style="color: #64748b; margin-top: 5px;">é¡§å®¢æƒ…å ±ã‚’ç®¡ç†ãƒ»æ¤œç´¢ã§ãã¾ã™</p>
            </div>
            <div style="display: flex; gap: 10px;">
                <span id="customerCount" class="info-badge">0ä»¶</span>
            </div>
        </div>

        <div class="customer-actions">
            <button id="quickRegisterBtn" class="btn btn-primary">
                âš¡ ã‚¯ã‚¤ãƒƒã‚¯ç™»éŒ²
            </button>
            <button onclick="dataExporter.showExportModal()" class="btn btn-outline" title="ãƒ‡ãƒ¼ã‚¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ">
                ğŸ“¥ ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
            </button>
            <button onclick="showFormURLModal()" class="btn btn-outline" title="é¡§å®¢ãƒ•ã‚©ãƒ¼ãƒ URLç”Ÿæˆ">
                ğŸ”— ãƒ•ã‚©ãƒ¼ãƒ URL
            </button>
        </div>

        <div class="search-container">
            <input type="text" 
                   class="search-input" 
                   id="searchInput" 
                   placeholder="ğŸ” åå‰ãƒ»ãƒ¡ãƒ¼ãƒ«ãƒ»é›»è©±ç•ªå·ã§æ¤œç´¢">
            
            <select id="statusFilter" class="search-input" style="max-width: 200px;">
                <option value="">å…¨ã¦ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</option>
                <option value="åˆå›ç›¸è«‡">åˆå›ç›¸è«‡</option>
                <option value="ç‰©ä»¶ç´¹ä»‹">ç‰©ä»¶ç´¹ä»‹</option>
                <option value="å†…è¦‹">å†…è¦‹</option>
                <option value="ç”³è¾¼">ç”³è¾¼</option>
                <option value="å¯©æŸ»">å¯©æŸ»</option>
                <option value="å¥‘ç´„">å¥‘ç´„</option>
                <option value="å®Œäº†">å®Œäº†</option>
            </select>
            
            <select id="sortOrder" class="search-input" style="max-width: 200px;">
                <option value="updatedDesc">æ›´æ–°æ—¥ï¼ˆæ–°ã—ã„é †ï¼‰</option>
                <option value="updatedAsc">æ›´æ–°æ—¥ï¼ˆå¤ã„é †ï¼‰</option>
                <option value="createdDesc">ç™»éŒ²æ—¥ï¼ˆæ–°ã—ã„é †ï¼‰</option>
                <option value="createdAsc">ç™»éŒ²æ—¥ï¼ˆå¤ã„é †ï¼‰</option>
                <option value="nameAsc">åå‰ï¼ˆæ˜‡é †ï¼‰</option>
                <option value="nameDesc">åå‰ï¼ˆé™é †ï¼‰</option>
            </select>
            
            <button onclick="clearFilters()" class="btn btn-outline">
                ã‚¯ãƒªã‚¢
            </button>
        </div>

        <div id="customerGrid" class="customer-grid">
            <!-- é¡§å®¢ã‚«ãƒ¼ãƒ‰ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ -->
        </div>

        <div id="noResults" style="display: none; text-align: center; padding: 60px 20px;">
            <div style="font-size: 48px; margin-bottom: 20px;">ğŸ“­</div>
            <h3 style="color: #64748b;">é¡§å®¢ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“</h3>
            <p style="color: #94a3b8;">æ¤œç´¢æ¡ä»¶ã‚’å¤‰æ›´ã™ã‚‹ã‹ã€æ–°ã—ã„é¡§å®¢ã‚’ç™»éŒ²ã—ã¦ãã ã•ã„</p>
        </div>
    </div>

    <!-- ã‚¯ã‚¤ãƒƒã‚¯ç™»éŒ²ãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div id="quickRegisterModal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h2>âš¡ ã‚¯ã‚¤ãƒƒã‚¯é¡§å®¢ç™»éŒ²</h2>
                <button onclick="closeQuickRegisterModal()" class="btn-close" type="button">Ã—</button>
            </div>
            <form id="quickRegisterForm" onsubmit="submitQuickRegister(event)">
                <div class="modal-body">
                    <p style="color: #64748b; margin-bottom: 20px;">
                        æœ€å°é™ã®æƒ…å ±ã§ç´ æ—©ãé¡§å®¢ã‚’ç™»éŒ²ã§ãã¾ã™ã€‚è©³ç´°ã¯å¾Œã‹ã‚‰ç·¨é›†å¯èƒ½ã§ã™ã€‚
                    </p>
                    
                    <div class="form-group">
                        <label for="quickName">ãŠåå‰ <span class="required">*</span></label>
                        <input type="text" id="quickName" name="name" required 
                               placeholder="ä¾‹: å±±ç”° å¤ªéƒ">
                    </div>
                    
                    <div class="form-group">
                        <label for="quickPhone">é›»è©±ç•ªå· <span class="required">*</span></label>
                        <input type="tel" id="quickPhone" name="phone" required 
                               placeholder="ä¾‹: 090-1234-5678">
                    </div>
                    
                    <div class="form-group">
                        <label for="quickEmail">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</label>
                        <input type="email" id="quickEmail" name="email" 
                               placeholder="ä¾‹: yamada@example.com">
                    </div>
                    
                    <div class="form-group">
                        <label for="quickStatus">ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</label>
                        <select id="quickStatus" name="status">
                            <option value="åˆå›ç›¸è«‡">åˆå›ç›¸è«‡</option>
                            <option value="ç‰©ä»¶ç´¹ä»‹">ç‰©ä»¶ç´¹ä»‹</option>
                            <option value="å†…è¦‹">å†…è¦‹</option>
                            <option value="ç”³è¾¼">ç”³è¾¼</option>
                            <option value="å¯©æŸ»">å¯©æŸ»</option>
                            <option value="å¥‘ç´„">å¥‘ç´„</option>
                            <option value="å®Œäº†">å®Œäº†</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="quickNote">ãƒ¡ãƒ¢</label>
                        <textarea id="quickNote" name="note" rows="3" 
                                  placeholder="ä¾‹: 3æœˆæœ«ã¾ã§ã«å¼•ã£è¶Šã—å¸Œæœ›"></textarea>
                    </div>
                </div>
                
                <div class="modal-footer">
                    <button type="button" onclick="closeQuickRegisterModal()" class="btn btn-outline">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
                    <button type="submit" class="btn btn-primary">âš¡ ç™»éŒ²ã™ã‚‹</button>
                </div>
            </form>
        </div>
    </div>

    <!-- é¡§å®¢è©³ç´°ãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div id="customerDetailModal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h2 id="detailCustomerName">é¡§å®¢è©³ç´°</h2>
                <button onclick="closeDetailModal()" class="btn-close">Ã—</button>
            </div>
            <div class="modal-body">
                <div id="customerDetailContent">
                    <!-- è©³ç´°æƒ…å ±ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ -->
                </div>
            </div>
            <div class="modal-footer">
                <button onclick="closeDetailModal()" class="btn btn-outline">é–‰ã˜ã‚‹</button>
                <button onclick="editCustomer()" class="btn btn-primary">ç·¨é›†</button>
                <button onclick="deleteCustomer()" class="btn btn-danger">å‰Šé™¤</button>
            </div>
        </div>
    </div>

    <!-- é¡§å®¢ç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div id="customerEditModal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h2>é¡§å®¢æƒ…å ±ç·¨é›†</h2>
                <button onclick="closeEditModal()" class="btn-close">Ã—</button>
            </div>
            <form id="editCustomerForm" onsubmit="saveCustomerEdit(event)">
                <div class="modal-body">
                    <!-- ç·¨é›†ãƒ•ã‚©ãƒ¼ãƒ ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ -->
                </div>
                <div class="modal-footer">
                    <button type="button" onclick="closeEditModal()" class="btn btn-outline">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
                    <button type="submit" class="btn btn-primary">ä¿å­˜</button>
                </div>
            </form>
        </div>
    </div>

    <!-- ãƒ•ã‚©ãƒ¼ãƒ URLç”Ÿæˆãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div id="formURLModal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h2>ğŸ”— é¡§å®¢å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ URL</h2>
                <button onclick="closeFormURLModal()" class="btn-close" type="button">Ã—</button>
            </div>
            <div class="modal-body">
                <p style="color: #64748b; margin-bottom: 20px;">
                    ã“ã®URLã‚’é¡§å®¢ã«é€ä¿¡ã™ã‚‹ã“ã¨ã§ã€é¡§å®¢è‡ªèº«ãŒæƒ…å ±ã‚’å…¥åŠ›ã§ãã¾ã™ã€‚
                </p>
                
                <div style="background: #f1f5f9; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 10px; font-weight: 600;">
                        ğŸ“‹ ãƒ•ã‚©ãƒ¼ãƒ URL
                    </label>
                    <div style="display: flex; gap: 10px;">
                        <input type="text" 
                               id="formURLDisplay" 
                               readonly 
                               style="flex: 1; padding: 10px; border: 1px solid #cbd5e1; border-radius: 6px; background: white;">
                        <button onclick="copyFormURL()" style="
                            padding: 10px 20px;
                            background: #3b82f6;
                            color: white;
                            border: none;
                            border-radius: 6px;
                            cursor: pointer;
                            white-space: nowrap;
                        ">
                            ğŸ“‹ ã‚³ãƒ”ãƒ¼
                        </button>
                    </div>
                </div>
                
                <div style="background: #fef3c7; padding: 15px; border-radius: 8px; border-left: 4px solid #f59e0b;">
                    <h4 style="margin: 0 0 10px 0; color: #92400e;">ğŸ’¡ ä½¿ã„æ–¹ã®ãƒ’ãƒ³ãƒˆ</h4>
                    <ul style="margin: 0; padding-left: 20px; color: #92400e;">
                        <li>ãƒ¡ãƒ¼ãƒ«ã‚„LINEã§URLã‚’é€ä¿¡</li>
                        <li>QRã‚³ãƒ¼ãƒ‰ã‚’ç”Ÿæˆã—ã¦åº—èˆ—ã«è¨­ç½®</li>
                        <li>ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã«ãƒªãƒ³ã‚¯ã‚’è¨­ç½®</li>
                    </ul>
                </div>
            </div>
            <div class="modal-footer">
                <button onclick="closeFormURLModal()" class="btn btn-outline">é–‰ã˜ã‚‹</button>
                <a href="${formURL}" target="_blank" class="btn btn-primary" style="text-decoration: none;">
                    ğŸ”— ãƒ•ã‚©ãƒ¼ãƒ ã‚’é–‹ã
                </a>
            </div>
        </div>
    </div>

    <!-- ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div id="exportModal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h2>ğŸ“¥ ãƒ‡ãƒ¼ã‚¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</h2>
                <button onclick="dataExporter.closeModal()" class="btn-close">Ã—</button>
            </div>
            <div class="modal-body">
                <p style="color: #64748b; margin-bottom: 20px;">
                    é¡§å®¢ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚‹å½¢å¼ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚
                </p>
                
                <div class="export-options">
                    <button onclick="dataExporter.exportAsCSV()" class="export-option">
                        <span class="export-icon">ğŸ“Š</span>
                        <span class="export-label">CSVå½¢å¼</span>
                        <span class="export-desc">Excelç­‰ã§é–‹ã‘ã¾ã™</span>
                    </button>
                    
                    <button onclick="dataExporter.exportAsJSON()" class="export-option">
                        <span class="export-icon">ğŸ’¾</span>
                        <span class="export-label">JSONå½¢å¼</span>
                        <span class="export-desc">ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ»é€£æºç”¨</span>
                    </button>
                </div>
                
                <div style="margin-top: 20px; padding: 15px; background: #f0f9ff; border-radius: 8px; border-left: 4px solid #0284c7;">
                    <p style="margin: 0; color: #0c4a6e; font-size: 14px;">
                        <strong>ğŸ’¡ ãƒ’ãƒ³ãƒˆ:</strong> ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ãŸãƒ‡ãƒ¼ã‚¿ã¯å®šæœŸçš„ã«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã¨ã—ã¦ä¿å­˜ã™ã‚‹ã“ã¨ã‚’ãŠå‹§ã‚ã—ã¾ã™ã€‚
                    </p>
                </div>
            </div>
            <div class="modal-footer">
                <button onclick="dataExporter.closeModal()" class="btn btn-outline">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
            </div>
        </div>
    </div>

    <script src="js/navigation.js"></script>
    <script src="js/firebase-config.js"></script>
    <script src="js/customer.js"></script>
    <script src="js/export.js"></script>
</body>
</html>
