<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é¡§å®¢ç®¡ç† - RentPipe</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .main-content {
            max-width: 1200px;
            margin: 80px auto 0;
            padding: 40px 20px;
        }

        .page-header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
        }

        .page-header h1 {
            font-size: 48px;
            margin-bottom: 10px;
        }

        .page-header p {
            font-size: 18px;
            opacity: 0.9;
        }

        .auth-status {
            max-width: 1200px;
            margin: 0 auto 20px;
            padding: 15px 20px;
            border-radius: 12px;
            text-align: center;
            font-weight: 600;
        }

        .auth-status.success {
            background: #dcfce7;
            color: #166534;
            border: 2px solid #86efac;
        }

        .auth-status.warning {
            background: #fef3c7;
            color: #854d0e;
            border: 2px solid #fde68a;
        }

        .auth-status.error {
            background: #fee2e2;
            color: #991b1b;
            border: 2px solid #fca5a5;
        }

        .dashboard-container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        }

        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-card h3 {
            font-size: 42px;
            margin: 0 0 10px 0;
        }

        .stat-card p {
            margin: 0;
            font-size: 16px;
            opacity: 0.9;
        }

        .controls-container {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            align-items: center;
        }

        .filter-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 12px 24px;
            background: #f3f4f6;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            cursor: pointer;
            font-size: 15px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .filter-btn:hover {
            background: #e5e7eb;
            transform: translateY(-2px);
        }

        .filter-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
        }

        .add-button {
            padding: 12px 30px;
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .add-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4);
        }

        .customers-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .customer-card {
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 15px;
            padding: 25px;
            transition: all 0.3s ease;
            position: relative;
        }

        .customer-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border-color: #667eea;
        }

        .customer-card.inactive {
            opacity: 0.7;
            background: #f9fafb;
        }

        .customer-card.inactive .customer-name::after {
            content: " (éã‚¢ã‚¯ãƒ†ã‚£ãƒ–)";
            font-size: 12px;
            color: #9ca3af;
            font-weight: normal;
        }

        .customer-name {
            font-size: 22px;
            font-weight: bold;
            color: #1f2937;
            margin-bottom: 15px;
        }

        .customer-info {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 20px;
        }

        .info-row {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 14px;
            color: #6b7280;
        }

        .info-icon {
            font-size: 18px;
        }

        .status-badge {
            display: inline-block;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .status-åˆå›ç›¸è«‡ { background: #dbeafe; color: #1e40af; }
        .status-ç‰©ä»¶ç´¹ä»‹ { background: #e0e7ff; color: #4338ca; }
        .status-å†…è¦‹ { background: #fef3c7; color: #92400e; }
        .status-ç”³è¾¼ { background: #fed7aa; color: #9a3412; }
        .status-å¯©æŸ»ä¸­ { background: #fce7f3; color: #9f1239; }
        .status-å¥‘ç´„æ‰‹ç¶šã { background: #ddd6fe; color: #5b21b6; }
        .status-å®Œäº† { background: #d1fae5; color: #065f46; }

        .inactive-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            margin-left: 8px;
        }

        .inactive-completed { background: #d1fae5; color: #065f46; }
        .inactive-lost { background: #fee2e2; color: #991b1b; }
        .inactive-onhold { background: #fef3c7; color: #92400e; }

        .card-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .card-button {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            text-align: center;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .btn-success {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4);
        }

        .btn-warning {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: white;
        }

        .btn-warning:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(245, 158, 11, 0.4);
        }

        .btn-danger {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
        }

        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.4);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 9999;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .modal-header {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 20px;
            color: #1f2937;
        }

        .modal-body {
            margin-bottom: 30px;
        }

        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
        }

        .radio-option {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 15px;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .radio-option:hover {
            border-color: #667eea;
            background: #f9fafb;
        }

        .radio-option input[type="radio"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .radio-label {
            font-size: 16px;
            font-weight: 600;
            color: #1f2937;
        }

        .modal-textarea {
            width: 100%;
            min-height: 100px;
            padding: 15px;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            font-size: 14px;
            font-family: inherit;
            resize: vertical;
        }

        .modal-actions {
            display: flex;
            gap: 10px;
        }

        .modal-button {
            flex: 1;
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
    </style>
</head>
<body>
    <!-- ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ -->
    <div id="navigation"></div>

    <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
    <div class="main-content">
        <div class="page-header">
            <h1>ğŸ‘¥ é¡§å®¢ç®¡ç†</h1>
            <p>ã™ã¹ã¦ã®é¡§å®¢æƒ…å ±ã‚’ä¸€å…ƒç®¡ç†ï¼ˆGoogle Sheetsè‡ªå‹•åŒæœŸï¼‰</p>
        </div>

        <!-- èªè¨¼ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ -->
        <div id="auth-sync-status" class="auth-status warning">
            âš¡ èª­ã¿è¾¼ã¿ä¸­...
        </div>

        <!-- ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ -->
        <div class="dashboard-container">
            <!-- çµ±è¨ˆæƒ…å ± -->
            <div class="stats-container" id="stats-container">
                <!-- çµ±è¨ˆã‚«ãƒ¼ãƒ‰ãŒå‹•çš„ã«ç”Ÿæˆã•ã‚Œã¾ã™ -->
            </div>

            <!-- ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ« -->
            <div class="controls-container">
                <div class="filter-group">
                    <button class="filter-btn active" onclick="filterByStatus('all')">ã™ã¹ã¦</button>
                    <button class="filter-btn" onclick="filterByStatus('active')">ã‚¢ã‚¯ãƒ†ã‚£ãƒ–</button>
                    <button class="filter-btn" onclick="filterByStatus('inactive')">éã‚¢ã‚¯ãƒ†ã‚£ãƒ–</button>
                    <button class="filter-btn" onclick="filterByStatus('completed')">å®Œäº†</button>
                    <button class="filter-btn" onclick="filterByStatus('lost')">å¤±æ³¨</button>
                    <button class="filter-btn" onclick="filterByStatus('on-hold')">ä¿ç•™</button>
                </div>
                <a href="customer-form.html" class="add-button">â• æ–°è¦é¡§å®¢ç™»éŒ²</a>
            </div>

            <!-- é¡§å®¢ã‚«ãƒ¼ãƒ‰ä¸€è¦§ -->
            <div class="customers-grid" id="customers-container">
                <!-- é¡§å®¢ã‚«ãƒ¼ãƒ‰ãŒå‹•çš„ã«ç”Ÿæˆã•ã‚Œã¾ã™ -->
            </div>
        </div>
    </div>

    <!-- éã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–ãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div id="deactivateModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">é¡§å®¢ã‚’éã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–</div>
            <div class="modal-body">
                <div class="radio-group">
                    <label class="radio-option">
                        <input type="radio" name="inactiveReason" value="completed" checked>
                        <span class="radio-label">âœ… æˆç´„å®Œäº†</span>
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="inactiveReason" value="lost">
                        <span class="radio-label">âŒ è¦‹è¾¼ã¿ãªã—ï¼ˆå¤±æ³¨ï¼‰</span>
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="inactiveReason" value="on-hold">
                        <span class="radio-label">â¸ï¸ æ™‚æœŸæœªåˆ°æ¥ï¼ˆä¿ç•™ï¼‰</span>
                    </label>
                </div>
                <textarea id="deactivateNote" class="modal-textarea" placeholder="ãƒ¡ãƒ¢ï¼ˆä»»æ„ï¼‰"></textarea>
            </div>
            <div class="modal-actions">
                <button class="modal-button btn-danger" onclick="closeDeactivateModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
                <button class="modal-button btn-primary" onclick="confirmDeactivate()">ç¢ºå®š</button>
            </div>
        </div>
    </div>

    <!-- Google API Client & Identity Services -->
    <script src="https://accounts.google.com/gsi/client"></script>
    <script src="https://apis.google.com/js/api.js"></script>
    
    <!-- RentPipe Core Scripts -->
    <script src="js/navigation.js"></script>
    <script src="js/integrated-auth-manager-v2.js"></script>
    
    <!-- Google Integration Scripts -->
    <script src="js/google-drive-api-v2.js"></script>
    <script src="js/google-sheets-api.js"></script>
    
    <!-- Data Management -->
    <script src="js/unified-sheets-manager.js"></script>
    <script src="js/unified-data-manager.js"></script>
    
    <script>
        let currentFilter = 'all';
        let deactivateCustomerId = null;

        // ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ä½œæˆ
        if (window.createNavigation) {
            document.getElementById('navigation').innerHTML = window.createNavigation();
        }

        // åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('ğŸš€ é¡§å®¢ç®¡ç†ç”»é¢åˆæœŸåŒ–é–‹å§‹');
            
            try {
                await checkAuth();
                await waitForDataManager();
                
                displayCustomers();
                updateStats();
                
                // ãƒ‡ãƒ¼ã‚¿æ›´æ–°ã‚¤ãƒ™ãƒ³ãƒˆã®ãƒªã‚¹ãƒŠãƒ¼
                window.addEventListener('rentpipe-data-updated', () => {
                    console.log('ğŸ“¢ ãƒ‡ãƒ¼ã‚¿æ›´æ–°æ¤œçŸ¥');
                    displayCustomers();
                    updateStats();
                });
                
                console.log('âœ… é¡§å®¢ç®¡ç†ç”»é¢åˆæœŸåŒ–å®Œäº†');
            } catch (error) {
                console.error('âŒ åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:', error);
            }
        });

        async function checkAuth() {
            const authData = localStorage.getItem('rentpipe_auth');
            const statusDiv = document.getElementById('auth-sync-status');
            
            if (!authData) {
                statusDiv.className = 'auth-status error';
                statusDiv.textContent = 'âŒ æœªèªè¨¼ - ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãã ã•ã„';
                setTimeout(() => {
                    window.location.href = 'login.html';
                }, 2000);
                throw new Error('èªè¨¼ãŒå¿…è¦ã§ã™');
            }
            
            statusDiv.className = 'auth-status success';
            statusDiv.textContent = 'âœ… èªè¨¼æ¸ˆã¿ - Google SheetsåŒæœŸä¸­';
        }

        async function waitForDataManager() {
            let attempts = 0;
            while (!window.UnifiedDataManager && attempts < 50) {
                await new Promise(resolve => setTimeout(resolve, 100));
                attempts++;
            }
            
            if (!window.UnifiedDataManager) {
                throw new Error('ãƒ‡ãƒ¼ã‚¿ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ãŒåˆ©ç”¨ã§ãã¾ã›ã‚“');
            }
        }

        function updateStats() {
            const stats = window.UnifiedDataManager.getStats();
            
            const statsHTML = `
                <div class="stat-card">
                    <h3>${stats.total}</h3>
                    <p>ç·é¡§å®¢æ•°</p>
                </div>
                <div class="stat-card">
                    <h3>${stats.active}</h3>
                    <p>ã‚¢ã‚¯ãƒ†ã‚£ãƒ–</p>
                </div>
                <div class="stat-card">
                    <h3>${stats.completed}</h3>
                    <p>æˆç´„æ¸ˆã¿</p>
                </div>
                <div class="stat-card">
                    <h3>${stats.lost}</h3>
                    <p>å¤±æ³¨</p>
                </div>
                <div class="stat-card">
                    <h3>${stats.onHold}</h3>
                    <p>ä¿ç•™ä¸­</p>
                </div>
            `;
            
            document.getElementById('stats-container').innerHTML = statsHTML;
        }

        function createCustomerCard(customer) {
            const card = document.createElement('div');
            card.className = 'customer-card' + (customer.isActive === false ? ' inactive' : '');
            
            let inactiveBadge = '';
            if (customer.isActive === false) {
                const badgeClass = customer.inactiveReason === 'completed' ? 'inactive-completed' :
                                  customer.inactiveReason === 'lost' ? 'inactive-lost' : 'inactive-onhold';
                const badgeText = customer.inactiveReason === 'completed' ? 'æˆç´„å®Œäº†' :
                                 customer.inactiveReason === 'lost' ? 'å¤±æ³¨' : 'ä¿ç•™';
                inactiveBadge = `<span class="inactive-badge ${badgeClass}">${badgeText}</span>`;
            }
            
            const statusClass = `status-${customer.pipelineStatus || 'åˆå›ç›¸è«‡'}`;
            
            let actions = '';
            if (customer.isActive === false) {
                // éã‚¢ã‚¯ãƒ†ã‚£ãƒ–é¡§å®¢ã®å ´åˆ
                actions = `
                    <a href="customer-detail.html?id=${customer.id}" class="card-button btn-primary">è©³ç´°ã‚’è¦‹ã‚‹</a>
                    <button class="card-button btn-success" onclick="reactivateCustomer('${customer.id}')">å†ã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–</button>
                `;
            } else {
                // ã‚¢ã‚¯ãƒ†ã‚£ãƒ–é¡§å®¢ã®å ´åˆ
                actions = `
                    <a href="customer-form.html?edit=${customer.id}" class="card-button btn-primary">ç·¨é›†</a>
                    <button class="card-button btn-warning" onclick="openDeactivateModal('${customer.id}')">éã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–</button>
                    <button class="card-button btn-danger" onclick="deleteCustomer('${customer.id}')">å‰Šé™¤</button>
                `;
            }
            
            card.innerHTML = `
                <div class="customer-name">${customer.name || 'åå‰æœªè¨­å®š'}</div>
                <div class="status-badge ${statusClass}">${customer.pipelineStatus || 'åˆå›ç›¸è«‡'}</div>
                ${inactiveBadge}
                <div class="customer-info">
                    <div class="info-row">
                        <span class="info-icon">ğŸ“§</span>
                        <span>${customer.email || 'æœªè¨­å®š'}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-icon">ğŸ“±</span>
                        <span>${customer.phone || 'æœªè¨­å®š'}</span>
                    </div>
                    ${customer.inactiveNote ? `
                        <div class="info-row">
                            <span class="info-icon">ğŸ“</span>
                            <span>${customer.inactiveNote}</span>
                        </div>
                    ` : ''}
                </div>
                <div class="card-actions">
                    ${actions}
                </div>
            `;
            
            return card;
        }

        function displayCustomers() {
            const container = document.getElementById('customers-container');
            container.innerHTML = '';
            
            let customers = window.UnifiedDataManager.getCustomers();
            
            // ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
            if (currentFilter === 'active') {
                customers = customers.filter(c => c.isActive !== false);
            } else if (currentFilter === 'inactive') {
                customers = customers.filter(c => c.isActive === false);
            } else if (currentFilter === 'completed') {
                customers = customers.filter(c => c.inactiveReason === 'completed');
            } else if (currentFilter === 'lost') {
                customers = customers.filter(c => c.inactiveReason === 'lost');
            } else if (currentFilter === 'on-hold') {
                customers = customers.filter(c => c.inactiveReason === 'on-hold');
            }
            
            if (customers.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #9ca3af; padding: 40px;">è©²å½“ã™ã‚‹é¡§å®¢ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“</p>';
                return;
            }
            
            customers.forEach(customer => {
                const card = createCustomerCard(customer);
                container.appendChild(card);
            });
        }

        function filterByStatus(status) {
            currentFilter = status;
            
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            displayCustomers();
        }

        function openDeactivateModal(customerId) {
            deactivateCustomerId = customerId;
            document.getElementById('deactivateModal').classList.add('active');
        }

        function closeDeactivateModal() {
            deactivateCustomerId = null;
            document.getElementById('deactivateModal').classList.remove('active');
            document.getElementById('deactivateNote').value = '';
        }

        async function confirmDeactivate() {
            if (!deactivateCustomerId) return;
            
            const reason = document.querySelector('input[name="inactiveReason"]:checked').value;
            const note = document.getElementById('deactivateNote').value;
            
            try {
                await window.UnifiedDataManager.deactivateCustomer(deactivateCustomerId, reason, note);
                
                const reasonText = reason === 'completed' ? 'æˆç´„å®Œäº†' :
                                  reason === 'lost' ? 'å¤±æ³¨' : 'ä¿ç•™';
                
                alert(`âœ… é¡§å®¢ã‚’éã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–ã—ã¾ã—ãŸï¼ˆ${reasonText}ï¼‰`);
                
                closeDeactivateModal();
                displayCustomers();
                updateStats();
            } catch (error) {
                console.error('âŒ éã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–ã‚¨ãƒ©ãƒ¼:', error);
                alert('âŒ éã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–ã«å¤±æ•—ã—ã¾ã—ãŸ');
            }
        }

        async function reactivateCustomer(customerId) {
            if (!confirm('ã“ã®é¡§å®¢ã‚’å†ã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–ã—ã¾ã™ã‹ï¼Ÿ')) {
                return;
            }
            
            try {
                await window.UnifiedDataManager.reactivateCustomer(customerId);
                alert('âœ… é¡§å®¢ã‚’å†ã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–ã—ã¾ã—ãŸ');
                displayCustomers();
                updateStats();
            } catch (error) {
                console.error('âŒ å†ã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–ã‚¨ãƒ©ãƒ¼:', error);
                alert('âŒ å†ã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–ã«å¤±æ•—ã—ã¾ã—ãŸ');
            }
        }

        async function deleteCustomer(customerId) {
            if (!confirm('ã“ã®é¡§å®¢ã‚’å®Œå…¨ã«å‰Šé™¤ã—ã¦ã‚‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ\nâ€»ã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“')) {
                return;
            }
            
            try {
                await window.UnifiedDataManager.deleteCustomer(customerId);
                displayCustomers();
                updateStats();
                alert('âœ… é¡§å®¢ã‚’å‰Šé™¤ã—ã¾ã—ãŸ');
            } catch (error) {
                console.error('âŒ å‰Šé™¤ã‚¨ãƒ©ãƒ¼:', error);
                alert('âŒ å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸ');
            }
        }
    </script>
</body>
</html>
