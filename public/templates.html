<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ - RentPipe</title>
    <link rel="stylesheet" href="css/main.css">
    <style>
        .templates-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }

        .page-header {
            margin-bottom: 30px;
        }

        .page-header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }

        .page-header p {
            color: #6b7280;
        }

        /* ã‚«ãƒ†ã‚´ãƒªãƒ¼ã‚¿ãƒ– */
        .category-tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 24px;
            flex-wrap: wrap;
        }

        .category-tab {
            padding: 10px 20px;
            border: 2px solid #e5e7eb;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s;
        }

        .category-tab:hover {
            border-color: #3b82f6;
        }

        .category-tab.active {
            background: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }

        /* é¡§å®¢é¸æŠ */
        .customer-select-section {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            margin-bottom: 24px;
        }

        .customer-select-section h3 {
            margin: 0 0 12px 0;
            font-size: 16px;
            color: #374151;
        }

        .customer-select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 14px;
            background: white;
        }

        .customer-select:focus {
            outline: none;
            border-color: #3b82f6;
        }

        /* ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚«ãƒ¼ãƒ‰ */
        .template-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            margin-bottom: 16px;
        }

        .template-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 16px;
        }

        .template-title {
            font-size: 16px;
            font-weight: 600;
            color: #1f2937;
            margin: 0 0 4px 0;
        }

        .template-description {
            font-size: 13px;
            color: #6b7280;
            margin: 0;
        }

        .template-badge {
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }

        .template-badge.pipeline {
            background: #dbeafe;
            color: #1e40af;
        }

        .template-badge.followup {
            background: #d1fae5;
            color: #065f46;
        }

        .template-content {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 16px;
            font-size: 14px;
            line-height: 1.8;
            color: #334155;
            white-space: pre-wrap;
            font-family: inherit;
        }

        .template-actions {
            display: flex;
            gap: 10px;
            margin-top: 16px;
        }

        .copy-btn {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 10px 18px;
            background: #3b82f6;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .copy-btn:hover {
            background: #2563eb;
        }

        .copy-btn.copied {
            background: #10b981;
        }

        /* å¤‰æ•°ã®ãƒã‚¤ãƒ©ã‚¤ãƒˆ */
        .template-content .variable {
            background: #fef3c7;
            color: #92400e;
            padding: 1px 4px;
            border-radius: 3px;
            font-weight: 500;
        }

        /* ç©ºçŠ¶æ…‹ */
        .empty-templates {
            text-align: center;
            padding: 60px 20px;
            color: #9ca3af;
        }

        .empty-templates .empty-icon {
            font-size: 48px;
            margin-bottom: 16px;
        }

        /* ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºãƒ’ãƒ³ãƒˆ */
        .customization-hint {
            background: #fffbeb;
            border: 1px solid #fcd34d;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 24px;
        }

        .customization-hint h4 {
            margin: 0 0 8px 0;
            color: #92400e;
            font-size: 14px;
        }

        .customization-hint p {
            margin: 0;
            font-size: 13px;
            color: #78350f;
        }

        .variable-list {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin-top: 8px;
        }

        .variable-tag {
            background: #fef3c7;
            color: #92400e;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <!-- ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ -->
    <div id="navigation"></div>

    <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
    <div class="templates-container">
        <div class="page-header">
            <h1>ğŸ“ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ</h1>
            <p>é¡§å®¢ã¸ã®é€£çµ¡æ–‡æ¡ˆã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ã€LINEãƒ»ãƒ¡ãƒ¼ãƒ«ãƒ»SMSãªã©ã§ã”åˆ©ç”¨ãã ã•ã„</p>
        </div>

        <!-- ã‚«ãƒ†ã‚´ãƒªãƒ¼ã‚¿ãƒ– -->
        <div class="category-tabs">
            <button class="category-tab active" data-category="all" onclick="filterByCategory('all')">ã™ã¹ã¦</button>
            <button class="category-tab" data-category="pipeline" onclick="filterByCategory('pipeline')">ğŸ“‹ å•†è«‡é€²è¡Œä¸­</button>
            <button class="category-tab" data-category="followup" onclick="filterByCategory('followup')">ğŸ”„ æˆç´„å¾Œãƒ•ã‚©ãƒ­ãƒ¼</button>
        </div>

        <!-- é¡§å®¢é¸æŠ -->
        <div class="customer-select-section">
            <h3>ğŸ‘¤ é¡§å®¢ã‚’é¸æŠï¼ˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«åå‰ã‚’åæ˜ ï¼‰</h3>
            <select class="customer-select" id="customerSelect" onchange="updateTemplates()">
                <option value="">-- é¡§å®¢ã‚’é¸æŠã—ã¦ãã ã•ã„ --</option>
            </select>
        </div>

        <!-- ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºãƒ’ãƒ³ãƒˆ -->
        <div class="customization-hint">
            <h4>ğŸ’¡ ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ä½¿ã„æ–¹</h4>
            <p>ã€Œã‚³ãƒ”ãƒ¼ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã€ãŠä½¿ã„ã®é€£çµ¡ãƒ„ãƒ¼ãƒ«ï¼ˆLINEã€ãƒ¡ãƒ¼ãƒ«ã€SMSãªã©ï¼‰ã«è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„ã€‚</p>
            <div class="variable-list">
                <span class="variable-tag">{ãŠå®¢æ§˜å}</span>
                <span class="variable-tag">{æ‹…å½“è€…å}</span>
                <span class="variable-tag">{ç‰©ä»¶å}</span>
                <span class="variable-tag">{æ—¥æ™‚}</span>
            </div>
        </div>

        <!-- ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆä¸€è¦§ -->
        <div id="templates-list">
            <!-- ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ -->
        </div>
    </div>

    <!-- ã‚¹ã‚¯ãƒªãƒ—ãƒˆ -->
    <script src="js/navigation.js"></script>
    <script src="js/integrated-auth-manager-v2.js"></script>
    <script src="js/unified-data-manager.js"></script>
    <script src="js/app-initializer.js"></script>
    <script src="js/page-initializer.js"></script>

    <script>
        let currentCategory = 'all';
        let selectedCustomer = null;
        let agentName = 'æ‹…å½“è€…'; // è¨­å®šã‹ã‚‰å–å¾—ã™ã‚‹ã‹ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤

        // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå®šç¾©
        const messageTemplates = [
            // ===== å•†è«‡é€²è¡Œä¸­ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ =====
            {
                id: 'initial-contact',
                category: 'pipeline',
                status: 'åˆå›ç›¸è«‡',
                title: 'åˆå›ç›¸è«‡å¾Œã®ãŠç¤¼ãƒ»æ¬¡å›é€£çµ¡',
                description: 'åˆå›ãƒ’ã‚¢ãƒªãƒ³ã‚°å¾Œã«ãŠé€ã‚Šã™ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸',
                template: `{ãŠå®¢æ§˜å}æ§˜

æœ¬æ—¥ã¯ãŠæ™‚é–“ã‚’ã„ãŸã ãã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚
{æ‹…å½“è€…å}ã§ã™ã€‚

ãŠèãã—ãŸæ¡ä»¶ã‚’ã‚‚ã¨ã«ã€ã”å¸Œæœ›ã«åˆã†ç‰©ä»¶ã‚’ãŠæ¢ã—ã„ãŸã—ã¾ã™ã€‚
ã„ãã¤ã‹å€™è£œãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸã‚‰ã”é€£çµ¡ã•ã›ã¦ã„ãŸã ãã¾ã™ã€‚

ã”ä¸æ˜ãªç‚¹ãŒã”ã–ã„ã¾ã—ãŸã‚‰ã€ã„ã¤ã§ã‚‚ãŠæ°—è»½ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚
å¼•ãç¶šãã‚ˆã‚ã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚`
            },
            {
                id: 'property-intro',
                category: 'pipeline',
                status: 'ç‰©ä»¶ç´¹ä»‹',
                title: 'ç‰©ä»¶ç´¹ä»‹ã®ã”æ¡ˆå†…',
                description: 'å€™è£œç‰©ä»¶ã‚’ã”ç´¹ä»‹ã™ã‚‹éš›ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸',
                template: `{ãŠå®¢æ§˜å}æ§˜

ãŠä¸–è©±ã«ãªã£ã¦ãŠã‚Šã¾ã™ã€‚
{æ‹…å½“è€…å}ã§ã™ã€‚

ã”å¸Œæœ›ã®æ¡ä»¶ã«åˆã†ç‰©ä»¶ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸã®ã§ã”ç´¹ä»‹ã•ã›ã¦ã„ãŸã ãã¾ã™ã€‚

ã€ã”ç´¹ä»‹ç‰©ä»¶ã€‘
ãƒ»ç‰©ä»¶åï¼š{ç‰©ä»¶å}
ãƒ»æ‰€åœ¨åœ°ï¼š
ãƒ»è³ƒæ–™ï¼š
ãƒ»é–“å–ã‚Šï¼š
ãƒ»ãã®ä»–ç‰¹å¾´ï¼š

ã”èˆˆå‘³ãŒã”ã–ã„ã¾ã—ãŸã‚‰ã€å†…è¦‹ã®ã”äºˆç´„ã‚‚æ‰¿ã£ã¦ãŠã‚Šã¾ã™ã€‚
ã”éƒ½åˆã®è‰¯ã„æ—¥æ™‚ã‚’ãŠçŸ¥ã‚‰ã›ã„ãŸã ã‘ã¾ã™ã§ã—ã‚‡ã†ã‹ã€‚

ã‚ˆã‚ã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚`
            },
            {
                id: 'viewing-schedule',
                category: 'pipeline',
                status: 'å†…è¦‹èª¿æ•´',
                title: 'å†…è¦‹æ—¥ç¨‹ç¢ºå®šã®ã”é€£çµ¡',
                description: 'å†…è¦‹æ—¥ç¨‹ãŒæ±ºã¾ã£ãŸéš›ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸',
                template: `{ãŠå®¢æ§˜å}æ§˜

ãŠä¸–è©±ã«ãªã£ã¦ãŠã‚Šã¾ã™ã€‚
{æ‹…å½“è€…å}ã§ã™ã€‚

å†…è¦‹ã®æ—¥ç¨‹ãŒç¢ºå®šã„ãŸã—ã¾ã—ãŸã®ã§ã”é€£çµ¡ã„ãŸã—ã¾ã™ã€‚

ã€å†…è¦‹äºˆå®šã€‘
ãƒ»æ—¥æ™‚ï¼š{æ—¥æ™‚}
ãƒ»ç‰©ä»¶ï¼š{ç‰©ä»¶å}
ãƒ»é›†åˆå ´æ‰€ï¼šç¾åœ°ï¼ˆä½æ‰€ã‚’ãŠé€ã‚Šã—ã¾ã™ï¼‰

å½“æ—¥ã¯ç§ãŒã”æ¡ˆå†…ã„ãŸã—ã¾ã™ã€‚
ã”ä¸æ˜ãªç‚¹ã‚„ã”è³ªå•ãŒã”ã–ã„ã¾ã—ãŸã‚‰ã€ãŠæ°—è»½ã«ãŠç”³ã—ä»˜ã‘ãã ã•ã„ã€‚

ã©ã†ãã‚ˆã‚ã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚`
            },
            {
                id: 'viewing-reminder',
                category: 'pipeline',
                status: 'å†…è¦‹èª¿æ•´',
                title: 'å†…è¦‹å‰æ—¥ãƒªãƒã‚¤ãƒ³ãƒ‰',
                description: 'å†…è¦‹å‰æ—¥ã«é€ã‚‹ç¢ºèªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸',
                template: `{ãŠå®¢æ§˜å}æ§˜

ãŠä¸–è©±ã«ãªã£ã¦ãŠã‚Šã¾ã™ã€‚
{æ‹…å½“è€…å}ã§ã™ã€‚

æ˜æ—¥ã®å†…è¦‹ã«ã¤ã„ã¦ã€æ”¹ã‚ã¦ã”æ¡ˆå†…ç”³ã—ä¸Šã’ã¾ã™ã€‚

ã€æ˜æ—¥ã®äºˆå®šã€‘
ãƒ»æ—¥æ™‚ï¼š{æ—¥æ™‚}
ãƒ»ç‰©ä»¶ï¼š{ç‰©ä»¶å}
ãƒ»é›†åˆå ´æ‰€ï¼šç¾åœ°

ãŠæ°—ã‚’ã¤ã‘ã¦ãŠè¶Šã—ãã ã•ã„ã€‚
æ˜æ—¥ãŠä¼šã„ã§ãã‚‹ã“ã¨ã‚’æ¥½ã—ã¿ã«ã—ã¦ãŠã‚Šã¾ã™ã€‚`
            },
            {
                id: 'after-viewing',
                category: 'pipeline',
                status: 'å†…è¦‹èª¿æ•´',
                title: 'å†…è¦‹å¾Œã®ãƒ•ã‚©ãƒ­ãƒ¼',
                description: 'å†…è¦‹çµ‚äº†å¾Œã«é€ã‚‹ãƒ•ã‚©ãƒ­ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸',
                template: `{ãŠå®¢æ§˜å}æ§˜

æœ¬æ—¥ã¯å†…è¦‹ã«ãŠè¶Šã—ã„ãŸã ãã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚
{æ‹…å½“è€…å}ã§ã™ã€‚

ã”è¦§ã„ãŸã ã„ãŸç‰©ä»¶ã¯ã„ã‹ãŒã§ã—ãŸã§ã—ã‚‡ã†ã‹ï¼Ÿ

ã”è³ªå•ã‚„ã”ä¸æ˜ãªç‚¹ãŒã”ã–ã„ã¾ã—ãŸã‚‰ã€ãŠæ°—è»½ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚
ã¾ãŸã€ä»–ã«ã‚‚æ¡ä»¶ã«åˆã†ç‰©ä»¶ãŒã”ã–ã„ã¾ã—ãŸã‚‰ã€ã”ç´¹ä»‹ã•ã›ã¦ã„ãŸã ãã¾ã™ã€‚

ã”æ¤œè¨ã®ã»ã©ã€ã‚ˆã‚ã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚`
            },
            {
                id: 'application-guide',
                category: 'pipeline',
                status: 'ç”³è¾¼æº–å‚™',
                title: 'ãŠç”³è¾¼ã¿æ‰‹ç¶šãã®ã”æ¡ˆå†…',
                description: 'ç”³è¾¼æ‰‹ç¶šãã®æµã‚Œã‚’ã”æ¡ˆå†…ã™ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸',
                template: `{ãŠå®¢æ§˜å}æ§˜

ãŠä¸–è©±ã«ãªã£ã¦ãŠã‚Šã¾ã™ã€‚
{æ‹…å½“è€…å}ã§ã™ã€‚

ã“ã®åº¦ã¯{ç‰©ä»¶å}ã¸ã®ãŠç”³è¾¼ã¿ã‚’ã”æ¤œè¨ã„ãŸã ãã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚

ã€ãŠç”³è¾¼ã¿ã«å¿…è¦ãªæ›¸é¡ã€‘
ãƒ»ã”æœ¬äººç¢ºèªæ›¸é¡ï¼ˆå…è¨±è¨¼ãƒ»ä¿é™ºè¨¼ãªã©ï¼‰
ãƒ»åå…¥è¨¼æ˜æ›¸ï¼ˆæºæ³‰å¾´åç¥¨ãƒ»çµ¦ä¸æ˜ç´°ãªã©ï¼‰
ãƒ»å°é‘‘

ã€ä»Šå¾Œã®æµã‚Œã€‘
1. å…¥å±…ç”³è¾¼æ›¸ã®ã”è¨˜å…¥
2. å¯©æŸ»ï¼ˆé€šå¸¸3ã€œ5å–¶æ¥­æ—¥ï¼‰
3. å¥‘ç´„æ‰‹ç¶šã
4. éµã®ãŠæ¸¡ã—ãƒ»å…¥å±…

ã”ä¸æ˜ãªç‚¹ãŒã”ã–ã„ã¾ã—ãŸã‚‰ã€ãŠæ°—è»½ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚`
            },
            {
                id: 'screening-progress',
                category: 'pipeline',
                status: 'å¯©æŸ»ä¸­',
                title: 'å¯©æŸ»çŠ¶æ³ã®ã”å ±å‘Š',
                description: 'å¯©æŸ»ã®é€²æ—ã‚’ãŠçŸ¥ã‚‰ã›ã™ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸',
                template: `{ãŠå®¢æ§˜å}æ§˜

ãŠä¸–è©±ã«ãªã£ã¦ãŠã‚Šã¾ã™ã€‚
{æ‹…å½“è€…å}ã§ã™ã€‚

ç¾åœ¨ã€{ç‰©ä»¶å}ã®å…¥å±…å¯©æŸ»ã‚’é€²ã‚ã¦ãŠã‚Šã¾ã™ã€‚
å¯©æŸ»çµæœãŒå‡ºã¾ã—ãŸã‚‰ã€æ”¹ã‚ã¦ã”é€£çµ¡ã•ã›ã¦ã„ãŸã ãã¾ã™ã€‚

é€šå¸¸ã€å¯©æŸ»ã«ã¯3ã€œ5å–¶æ¥­æ—¥ã»ã©ãŠæ™‚é–“ã‚’ã„ãŸã ã„ã¦ãŠã‚Šã¾ã™ã€‚
ä»Šã—ã°ã‚‰ããŠå¾…ã¡ãã ã•ã„ã¾ã™ã‚ˆã†ãŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚

ã”è³ªå•ãŒã”ã–ã„ã¾ã—ãŸã‚‰ã€ãŠæ°—è»½ã«ã”é€£çµ¡ãã ã•ã„ã€‚`
            },
            {
                id: 'screening-passed',
                category: 'pipeline',
                status: 'å¯©æŸ»ä¸­',
                title: 'å¯©æŸ»é€šéã®ãŠçŸ¥ã‚‰ã›',
                description: 'å¯©æŸ»é€šéã‚’ãŠçŸ¥ã‚‰ã›ã™ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸',
                template: `{ãŠå®¢æ§˜å}æ§˜

ãŠä¸–è©±ã«ãªã£ã¦ãŠã‚Šã¾ã™ã€‚
{æ‹…å½“è€…å}ã§ã™ã€‚

ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼
{ç‰©ä»¶å}ã®å…¥å±…å¯©æŸ»ãŒç„¡äº‹é€šéã„ãŸã—ã¾ã—ãŸã€‚

æ¬¡ã¯å¥‘ç´„æ‰‹ç¶šãã«é€²ã¿ã¾ã™ã€‚
ã”éƒ½åˆã®è‰¯ã„æ—¥ç¨‹ã‚’ãŠçŸ¥ã‚‰ã›ã„ãŸã ã‘ã¾ã™ã§ã—ã‚‡ã†ã‹ã€‚

ã€å¥‘ç´„æ™‚ã«ãŠæŒã¡ã„ãŸã ãã‚‚ã®ã€‘
ãƒ»ã”æœ¬äººç¢ºèªæ›¸é¡
ãƒ»å°é‘‘ï¼ˆèªå°å¯ï¼‰
ãƒ»åˆæœŸè²»ç”¨

è©³ç´°ã¯æ”¹ã‚ã¦ã”æ¡ˆå†…ã„ãŸã—ã¾ã™ã€‚
å¼•ãç¶šãã‚ˆã‚ã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚`
            },
            {
                id: 'contract-schedule',
                category: 'pipeline',
                status: 'å¥‘ç´„æ‰‹ç¶šã',
                title: 'å¥‘ç´„æ—¥ç¨‹ã®ã”æ¡ˆå†…',
                description: 'å¥‘ç´„æ—¥ç¨‹ãŒæ±ºã¾ã£ãŸéš›ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸',
                template: `{ãŠå®¢æ§˜å}æ§˜

ãŠä¸–è©±ã«ãªã£ã¦ãŠã‚Šã¾ã™ã€‚
{æ‹…å½“è€…å}ã§ã™ã€‚

å¥‘ç´„æ—¥ç¨‹ãŒç¢ºå®šã„ãŸã—ã¾ã—ãŸã®ã§ã”æ¡ˆå†…ã„ãŸã—ã¾ã™ã€‚

ã€å¥‘ç´„äºˆå®šã€‘
ãƒ»æ—¥æ™‚ï¼š{æ—¥æ™‚}
ãƒ»å ´æ‰€ï¼šå¼Šç¤¾äº‹å‹™æ‰€
ãƒ»æ‰€è¦æ™‚é–“ï¼šç´„1ã€œ2æ™‚é–“

ã€ãŠæŒã¡ã„ãŸã ãã‚‚ã®ã€‘
ãƒ»ã”æœ¬äººç¢ºèªæ›¸é¡
ãƒ»å°é‘‘
ãƒ»åˆæœŸè²»ç”¨ï¼ˆæŒ¯è¾¼ã§ã‚‚å¯ï¼‰

ã”ä¸æ˜ãªç‚¹ãŒã”ã–ã„ã¾ã—ãŸã‚‰ã€ãŠæ°—è»½ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚
å½“æ—¥ãŠä¼šã„ã§ãã‚‹ã“ã¨ã‚’æ¥½ã—ã¿ã«ã—ã¦ãŠã‚Šã¾ã™ã€‚`
            },

            // ===== æˆç´„å¾Œãƒ•ã‚©ãƒ­ãƒ¼ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ =====
            {
                id: 'move-in-thanks',
                category: 'followup',
                title: 'ã”å…¥å±…å¾Œã®ãŠç¤¼',
                description: 'å…¥å±…å¾Œã™ãã«ãŠé€ã‚Šã™ã‚‹ãŠç¤¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸',
                template: `{ãŠå®¢æ§˜å}æ§˜

ãŠä¸–è©±ã«ãªã£ã¦ãŠã‚Šã¾ã™ã€‚
{æ‹…å½“è€…å}ã§ã™ã€‚

ã“ã®åº¦ã¯ã”å…¥å±…ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼
æ–°ç”Ÿæ´»ã®ã‚¹ã‚¿ãƒ¼ãƒˆã¯ã„ã‹ãŒã§ã—ã‚‡ã†ã‹ã€‚

è¨­å‚™ã‚„ä½ç’°å¢ƒãªã©ã€ãŠå›°ã‚Šã®ã“ã¨ãŒã”ã–ã„ã¾ã—ãŸã‚‰ã„ã¤ã§ã‚‚ã”é€£çµ¡ãã ã•ã„ã€‚
å¿«é©ãªæ–°ç”Ÿæ´»ã‚’ãŠéã”ã—ã„ãŸã ã‘ã‚‹ã“ã¨ã‚’é¡˜ã£ã¦ãŠã‚Šã¾ã™ã€‚

ä»Šå¾Œã¨ã‚‚ã©ã†ãã‚ˆã‚ã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚`
            },
            {
                id: 'one-month-followup',
                category: 'followup',
                title: '1ãƒ¶æœˆå¾Œãƒ•ã‚©ãƒ­ãƒ¼',
                description: 'å…¥å±…1ãƒ¶æœˆå¾Œã®ãƒ•ã‚©ãƒ­ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸',
                template: `{ãŠå®¢æ§˜å}æ§˜

ãŠä¸–è©±ã«ãªã£ã¦ãŠã‚Šã¾ã™ã€‚
{æ‹…å½“è€…å}ã§ã™ã€‚

ã”å…¥å±…ã‹ã‚‰1ãƒ¶æœˆã»ã©çµŒã¡ã¾ã—ãŸãŒã€æ–°ç”Ÿæ´»ã¯ã„ã‹ãŒã§ã—ã‚‡ã†ã‹ï¼Ÿ

è¨­å‚™ã®ä¸å…·åˆã‚„ã”è¿‘æ‰€ã¨ã®é–¢ä¿‚ãªã©ã€ãŠå›°ã‚Šã®ã“ã¨ãŒã”ã–ã„ã¾ã—ãŸã‚‰ãŠæ°—è»½ã«ã”ç›¸è«‡ãã ã•ã„ã€‚
å°‘ã—ã§ã‚‚å¿«é©ã«ãŠéã”ã—ã„ãŸã ã‘ã‚‹ã‚ˆã†ã‚µãƒãƒ¼ãƒˆã„ãŸã—ã¾ã™ã€‚

ä»Šå¾Œã¨ã‚‚ã©ã†ãã‚ˆã‚ã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚`
            },
            {
                id: 'six-month-followup',
                category: 'followup',
                title: '6ãƒ¶æœˆå¾Œãƒ•ã‚©ãƒ­ãƒ¼',
                description: 'å…¥å±…6ãƒ¶æœˆå¾Œã®ãƒ•ã‚©ãƒ­ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸',
                template: `{ãŠå®¢æ§˜å}æ§˜

ãŠä¸–è©±ã«ãªã£ã¦ãŠã‚Šã¾ã™ã€‚
{æ‹…å½“è€…å}ã§ã™ã€‚

ã”å…¥å±…ã‹ã‚‰åŠå¹´ãŒçµŒã¡ã¾ã—ãŸãŒã€ãŠå¤‰ã‚ã‚ŠãªããŠéã”ã—ã§ã—ã‚‡ã†ã‹ã€‚

ã‚‚ã—ä½ã¿æ›¿ãˆã‚„ãŠéƒ¨å±‹æ¢ã—ã®ã”äºˆå®šãŒã”ã–ã„ã¾ã—ãŸã‚‰ã€ãœã²ãŠå£°ãŒã‘ãã ã•ã„ã€‚
ã¾ãŸã€ã”å‹äººã‚„ãŠçŸ¥ã‚Šåˆã„ã§ãŠéƒ¨å±‹ã‚’ãŠæ¢ã—ã®æ–¹ãŒã„ã‚‰ã£ã—ã‚ƒã„ã¾ã—ãŸã‚‰ã€ã”ç´¹ä»‹ã„ãŸã ã‘ã‚‹ã¨å¹¸ã„ã§ã™ã€‚

ä»Šå¾Œã¨ã‚‚ã©ã†ãã‚ˆã‚ã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚`
            },
            {
                id: 'one-year-followup',
                category: 'followup',
                title: '1å¹´å¾Œãƒ•ã‚©ãƒ­ãƒ¼',
                description: 'å…¥å±…1å¹´å¾Œã®ãƒ•ã‚©ãƒ­ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸',
                template: `{ãŠå®¢æ§˜å}æ§˜

ãŠä¸–è©±ã«ãªã£ã¦ãŠã‚Šã¾ã™ã€‚
{æ‹…å½“è€…å}ã§ã™ã€‚

æ—©ã„ã‚‚ã®ã§ã”å…¥å±…ã‹ã‚‰1å¹´ãŒçµŒã¡ã¾ã—ãŸã€‚
ãã®å¾Œã€å¿«é©ã«ãŠéã”ã—ã„ãŸã ã‘ã¦ãŠã‚Šã¾ã™ã§ã—ã‚‡ã†ã‹ã€‚

å¥‘ç´„æ›´æ–°ã‚„ä½ã¿æ›¿ãˆã«ã¤ã„ã¦ã€ã”è³ªå•ã‚„ã”ç›¸è«‡ãŒã”ã–ã„ã¾ã—ãŸã‚‰ãŠæ°—è»½ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚
å¼•ãç¶šãã‚µãƒãƒ¼ãƒˆã•ã›ã¦ã„ãŸã ãã¾ã™ã€‚

ä»Šå¾Œã¨ã‚‚ã©ã†ãã‚ˆã‚ã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚`
            },
            {
                id: 'renewal-reminder',
                category: 'followup',
                title: 'æ›´æ–°æ™‚æœŸã®ãŠçŸ¥ã‚‰ã›',
                description: 'å¥‘ç´„æ›´æ–°æ™‚æœŸãŒè¿‘ã¥ã„ãŸéš›ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸',
                template: `{ãŠå®¢æ§˜å}æ§˜

ãŠä¸–è©±ã«ãªã£ã¦ãŠã‚Šã¾ã™ã€‚
{æ‹…å½“è€…å}ã§ã™ã€‚

ç¾åœ¨ã®ã”å¥‘ç´„ãŒæ›´æ–°æ™‚æœŸã‚’è¿ãˆã¾ã™ã®ã§ã€ã”æ¡ˆå†…ã•ã›ã¦ã„ãŸã ãã¾ã™ã€‚

ã€æ›´æ–°ã«ã¤ã„ã¦ã€‘
ãƒ»æ›´æ–°æ–™ï¼š
ãƒ»æ›´æ–°å¾Œã®æ¡ä»¶ï¼šï¼ˆå¤‰æ›´ãŒã‚ã‚‹å ´åˆï¼‰

æ›´æ–°ã®ãŠæ‰‹ç¶šãã€ã¾ãŸã¯ä½ã¿æ›¿ãˆã®ã”ç›¸è«‡ãªã©ã€ã”å¸Œæœ›ãŒã”ã–ã„ã¾ã—ãŸã‚‰ãŠçŸ¥ã‚‰ã›ãã ã•ã„ã€‚
ã”ä¸æ˜ãªç‚¹ãŒã”ã–ã„ã¾ã—ãŸã‚‰ã€ãŠæ°—è»½ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚

ã‚ˆã‚ã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚`
            },
            {
                id: 'referral-request',
                category: 'followup',
                title: 'ã”ç´¹ä»‹ã®ãŠé¡˜ã„',
                description: 'ãŠçŸ¥ã‚Šåˆã„ã®ç´¹ä»‹ã‚’ãŠé¡˜ã„ã™ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸',
                template: `{ãŠå®¢æ§˜å}æ§˜

ã„ã¤ã‚‚å¤§å¤‰ãŠä¸–è©±ã«ãªã£ã¦ãŠã‚Šã¾ã™ã€‚
{æ‹…å½“è€…å}ã§ã™ã€‚

çªç„¶ã®ã”é€£çµ¡å¤±ç¤¼ã„ãŸã—ã¾ã™ã€‚
ã‚‚ã—ãŠçŸ¥ã‚Šåˆã„ã‚„ã”å‹äººã®æ–¹ã§ãŠéƒ¨å±‹æ¢ã—ã‚’ã•ã‚Œã¦ã„ã‚‹æ–¹ãŒã„ã‚‰ã£ã—ã‚ƒã„ã¾ã—ãŸã‚‰ã€ãœã²ã”ç´¹ä»‹ã„ãŸã ã‘ã‚‹ã¨å¹¸ã„ã§ã™ã€‚

{ãŠå®¢æ§˜å}æ§˜ã‹ã‚‰ã®ã”ç´¹ä»‹ã®ãŠå®¢æ§˜ã«ã¯ã€ç‰¹å…¸ã‚’ã”ç”¨æ„ã—ã¦ãŠã‚Šã¾ã™ã€‚

ã”æ¤œè¨ã„ãŸã ã‘ã¾ã—ãŸã‚‰å¬‰ã—ãæ€ã„ã¾ã™ã€‚
ä»Šå¾Œã¨ã‚‚ã©ã†ãã‚ˆã‚ã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚`
            }
        ];

        // ãƒšãƒ¼ã‚¸åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                await PageInitializer.initialize({
                    onDataUpdated: () => {
                        loadCustomerList();
                    }
                });

                loadCustomerList();
                renderTemplates();

            } catch (error) {
                console.error('templates.html åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:', error);
            }
        });

        // é¡§å®¢ãƒªã‚¹ãƒˆã‚’èª­ã¿è¾¼ã¿
        function loadCustomerList() {
            const select = document.getElementById('customerSelect');
            const customers = window.UnifiedDataManager ? window.UnifiedDataManager.getCustomers() : [];

            // ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªé¡§å®¢ã®ã¿è¡¨ç¤º
            const activeCustomers = customers.filter(c => c.isActive !== false);

            select.innerHTML = '<option value="">-- é¡§å®¢ã‚’é¸æŠã—ã¦ãã ã•ã„ --</option>';

            activeCustomers.forEach(customer => {
                const name = customer.basicInfo?.name || customer.name || 'åå‰æœªè¨­å®š';
                const status = customer.pipelineStatus || '';
                const option = document.createElement('option');
                option.value = customer.id;
                option.textContent = `${name}ï¼ˆ${status}ï¼‰`;
                select.appendChild(option);
            });
        }

        // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’æ›´æ–°
        function updateTemplates() {
            const customerId = document.getElementById('customerSelect').value;

            if (customerId) {
                const customers = window.UnifiedDataManager ? window.UnifiedDataManager.getCustomers() : [];
                selectedCustomer = customers.find(c => c.id === customerId);
            } else {
                selectedCustomer = null;
            }

            renderTemplates();
        }

        // ã‚«ãƒ†ã‚´ãƒªã§ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
        function filterByCategory(category) {
            currentCategory = category;

            document.querySelectorAll('.category-tab').forEach(tab => {
                tab.classList.toggle('active', tab.dataset.category === category);
            });

            renderTemplates();
        }

        // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’æç”»
        function renderTemplates() {
            const container = document.getElementById('templates-list');
            container.innerHTML = '';

            let templates = messageTemplates;

            // ã‚«ãƒ†ã‚´ãƒªã§ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
            if (currentCategory !== 'all') {
                templates = templates.filter(t => t.category === currentCategory);
            }

            // é¸æŠã—ãŸé¡§å®¢ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã«é–¢é€£ã™ã‚‹ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’å„ªå…ˆè¡¨ç¤º
            if (selectedCustomer && selectedCustomer.pipelineStatus) {
                const status = selectedCustomer.pipelineStatus;
                templates = templates.sort((a, b) => {
                    const aMatch = a.status === status ? 0 : 1;
                    const bMatch = b.status === status ? 0 : 1;
                    return aMatch - bMatch;
                });
            }

            if (templates.length === 0) {
                container.innerHTML = `
                    <div class="empty-templates">
                        <div class="empty-icon">ğŸ“­</div>
                        <p>è©²å½“ã™ã‚‹ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãŒã‚ã‚Šã¾ã›ã‚“</p>
                    </div>
                `;
                return;
            }

            templates.forEach(template => {
                const card = createTemplateCard(template);
                container.appendChild(card);
            });
        }

        // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚«ãƒ¼ãƒ‰ã‚’ä½œæˆ
        function createTemplateCard(template) {
            const card = document.createElement('div');
            card.className = 'template-card';

            const badgeClass = template.category === 'pipeline' ? 'pipeline' : 'followup';
            const badgeText = template.category === 'pipeline' ? `ğŸ“‹ ${template.status || 'å•†è«‡ä¸­'}` : 'ğŸ”„ æˆç´„å¾Œ';

            // å¤‰æ•°ã‚’ç½®æ›ã—ãŸãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå†…å®¹
            const content = replaceVariables(template.template);

            card.innerHTML = `
                <div class="template-header">
                    <div>
                        <h3 class="template-title">${template.title}</h3>
                        <p class="template-description">${template.description}</p>
                    </div>
                    <span class="template-badge ${badgeClass}">${badgeText}</span>
                </div>
                <div class="template-content">${escapeHtml(content)}</div>
                <div class="template-actions">
                    <button class="copy-btn" onclick="copyTemplate(this, '${template.id}')">
                        ğŸ“‹ ã‚³ãƒ”ãƒ¼
                    </button>
                </div>
            `;

            return card;
        }

        // å¤‰æ•°ã‚’ç½®æ›
        function replaceVariables(template) {
            let result = template;

            if (selectedCustomer) {
                const name = selectedCustomer.basicInfo?.name || selectedCustomer.name || 'ãŠå®¢æ§˜';
                result = result.replace(/{ãŠå®¢æ§˜å}/g, name);
            }

            result = result.replace(/{æ‹…å½“è€…å}/g, agentName);
            result = result.replace(/{ç‰©ä»¶å}/g, 'ï¼ˆç‰©ä»¶åï¼‰');
            result = result.replace(/{æ—¥æ™‚}/g, 'ï¼ˆæ—¥æ™‚ï¼‰');

            return result;
        }

        // HTMLã‚¨ã‚¹ã‚±ãƒ¼ãƒ—
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ã‚³ãƒ”ãƒ¼
        function copyTemplate(button, templateId) {
            const template = messageTemplates.find(t => t.id === templateId);
            if (!template) return;

            const content = replaceVariables(template.template);

            navigator.clipboard.writeText(content).then(() => {
                button.innerHTML = 'âœ… ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ';
                button.classList.add('copied');

                setTimeout(() => {
                    button.innerHTML = 'ğŸ“‹ ã‚³ãƒ”ãƒ¼';
                    button.classList.remove('copied');
                }, 2000);
            }).catch(err => {
                console.error('ã‚³ãƒ”ãƒ¼ã«å¤±æ•—:', err);
                alert('ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸã€‚æ‰‹å‹•ã§ãƒ†ã‚­ã‚¹ãƒˆã‚’é¸æŠã—ã¦ã‚³ãƒ”ãƒ¼ã—ã¦ãã ã•ã„ã€‚');
            });
        }

        console.log('âœ… ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒšãƒ¼ã‚¸æº–å‚™å®Œäº†');
    </script>
</body>
</html>
