<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/svg+xml" href="img/logo-icon.svg">
    <title>é¡§å®¢ã‚¤ãƒ³ãƒãƒ¼ãƒˆ - RentPipe</title>
    <link rel="stylesheet" href="css/main.css">
    <!-- Tailwind CSS (local build) -->
    <link rel="stylesheet" href="css/tailwind-output.css">
</head>
<body>
    <div id="navigation"></div>

    <div class="container">
        <div class="header-section">
            <h1>ğŸ“¥ é¡§å®¢ãƒ‡ãƒ¼ã‚¿ã‚¤ãƒ³ãƒãƒ¼ãƒˆ</h1>
            <p class="text-muted">CSV/JSONãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰é¡§å®¢ãƒ‡ãƒ¼ã‚¿ã‚’ä¸€æ‹¬ç™»éŒ²ã§ãã¾ã™</p>
        </div>

        <!-- ã‚¤ãƒ³ãƒãƒ¼ãƒˆæ–¹æ³•é¸æŠ -->
        <div class="card-rentpipe mb-4" style="margin-bottom: 24px;">
            <h2 style="font-size: 18px; margin-bottom: 16px;">ğŸ“‹ ã‚¤ãƒ³ãƒãƒ¼ãƒˆå½¢å¼</h2>
            <div class="flex gap-3" style="display: flex; gap: 12px; flex-wrap: wrap;">
                <button class="btn-rentpipe btn-rentpipe-primary active" data-format="csv" onclick="selectFormat('csv')">
                    ğŸ“„ CSVå½¢å¼
                </button>
                <button class="btn-rentpipe" data-format="json" onclick="selectFormat('json')">
                    ğŸ“¦ JSONå½¢å¼
                </button>
            </div>
        </div>

        <!-- CSVã‚¤ãƒ³ãƒãƒ¼ãƒˆ -->
        <div id="csv-import" class="import-section">
            <div class="card-rentpipe">
                <h2 style="font-size: 18px; margin-bottom: 16px;">ğŸ“„ CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</h2>

                <!-- ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚¨ãƒªã‚¢ -->
                <div class="upload-area" id="csv-upload-area">
                    <input type="file" id="csv-file-input" accept=".csv" style="display: none;" onchange="handleCsvFile(event)">
                    <label for="csv-file-input" class="upload-label">
                        <div class="upload-icon">ğŸ“</div>
                        <p class="upload-text">ã‚¯ãƒªãƒƒã‚¯ã—ã¦CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ</p>
                        <p class="upload-hint">ã¾ãŸã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—</p>
                    </label>
                </div>

                <!-- CSVãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆä¾‹ -->
                <div class="mt-4" style="margin-top: 24px;">
                    <h3 style="font-size: 16px; margin-bottom: 12px;">ğŸ“ CSVãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ</h3>
                    <p style="font-size: 14px; color: #6b7280; margin-bottom: 12px;">
                        RentPipeã®å…¨é …ç›®ã«å¯¾å¿œã—ãŸè©³ç´°ãªãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã§ã™ã€‚<br>
                        å¿…é ˆé …ç›®ã¯ã€Œnameï¼ˆãŠåå‰ï¼‰ã€ã¨ã€Œphoneï¼ˆé›»è©±ç•ªå·ï¼‰ã€ã®ã¿ã§ã™ã€‚ãã®ä»–ã¯ç©ºæ¬„ã§ã‚‚æ§‹ã„ã¾ã›ã‚“ã€‚
                    </p>
                    <div style="background: #f9fafb; padding: 12px; border-radius: 6px; margin-bottom: 12px;">
                        <h4 style="font-size: 14px; margin: 0 0 8px 0; color: #1f2937;">ğŸ“‹ é …ç›®ä¸€è¦§ï¼ˆå…¨60é …ç›®ï¼‰</h4>
                        <div style="font-size: 12px; color: #6b7280; line-height: 1.6; columns: 2; column-gap: 20px;">
                            <div>åŸºæœ¬æƒ…å ±: name*, nameKana, email, phone*, birthday, gender, currentAddress</div>
                            <div>ä½å±…ãƒ»è·æ¥­: currentHousing, numberOfOccupants, occupation, companyName, yearsEmployed, annualIncome, movingReason</div>
                            <div>å¸Œæœ›æ¡ä»¶: budgetMin, budgetMax, moveInDate, areas, layout, roomSize, stationWalk, floor</div>
                            <div>è¨­å‚™æ¡ä»¶: separateBath, separateWashroom, autoLock, indoorWashing, ãªã©å…¨30é …ç›®</div>
                            <div>å¥‘ç´„æƒ…å ±: contractType, contractStartDate, contractEndDate, monthlyRent, ãªã©</div>
                            <div>ãã®ä»–: pipelineStatus, notes, agentMemo</div>
                        </div>
                    </div>
                    <div class="flex gap-3 flex-wrap mt-2" style="display:flex; gap:10px; flex-wrap:wrap; margin-top:10px;">
                        <button class="btn-rentpipe btn-rentpipe-primary" onclick="downloadCsvTemplate()">
                            â¬‡ï¸ è©³ç´°ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
                        </button>
                        <button class="btn-rentpipe" onclick="toggleFieldGuide()" id="guide-toggle-btn" style="border:2px solid #3d4e6b; color:#3d4e6b; background:white;">
                            ğŸ“– é …ç›®ã‚¬ã‚¤ãƒ‰ã‚’è¦‹ã‚‹
                        </button>
                    </div>

                    <!-- é …ç›®ã‚¬ã‚¤ãƒ‰ï¼ˆæŠ˜ã‚ŠãŸãŸã¿ï¼‰ -->
                    <div id="field-guide" style="display:none; margin-top:20px;">
                        <div style="background:#f0f4ff; border:1px solid #c7d2fe; border-radius:12px; padding:20px;">
                            <h4 style="font-size:15px; font-weight:700; color:#3730a3; margin:0 0 16px 0;">ğŸ“– CSVãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ é …ç›®ã‚¬ã‚¤ãƒ‰</h4>

                            <!-- å¿…é ˆé …ç›® -->
                            <div class="guide-section">
                                <div class="guide-section-title" style="background:#fef2f2; color:#991b1b; border-color:#fecaca;">
                                    âš ï¸ å¿…é ˆé …ç›®ï¼ˆ2é …ç›®ï¼‰
                                </div>
                                <table class="guide-table">
                                    <thead><tr><th>åˆ—å</th><th>é …ç›®å</th><th>èª¬æ˜ãƒ»å…¥åŠ›ä¾‹</th></tr></thead>
                                    <tbody>
                                        <tr><td><code>name</code></td><td>æ°å</td><td>é¡§å®¢ã®æ°åã€‚ä¾‹: <em>å±±ç”°å¤ªéƒ</em></td></tr>
                                        <tr><td><code>phone</code></td><td>é›»è©±ç•ªå·</td><td>ãƒã‚¤ãƒ•ãƒ³ã‚ã‚Šãƒ»ãªã—ä¸¡æ–¹å¯ã€‚ä¾‹: <em>090-1234-5678</em></td></tr>
                                    </tbody>
                                </table>
                            </div>

                            <!-- åŸºæœ¬æƒ…å ± -->
                            <div class="guide-section">
                                <div class="guide-section-title" style="background:#eff6ff; color:#3d4e6b; border-color:#bfdbfe;">
                                    ğŸ‘¤ åŸºæœ¬æƒ…å ±
                                </div>
                                <table class="guide-table">
                                    <thead><tr><th>åˆ—å</th><th>é …ç›®å</th><th>èª¬æ˜ãƒ»å…¥åŠ›ä¾‹</th></tr></thead>
                                    <tbody>
                                        <tr><td><code>nameKana</code></td><td>æ°åï¼ˆãƒ•ãƒªã‚¬ãƒŠï¼‰</td><td>å…¨è§’ã‚«ã‚¿ã‚«ãƒŠã€‚ä¾‹: <em>ãƒ¤ãƒãƒ€ã‚¿ãƒ­ã‚¦</em></td></tr>
                                        <tr><td><code>email</code></td><td>ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</td><td>ä¾‹: <em>yamada@example.com</em></td></tr>
                                        <tr><td><code>birthday</code></td><td>ç”Ÿå¹´æœˆæ—¥</td><td>YYYY-MM-DDå½¢å¼ã€‚ä¾‹: <em>1990-01-15</em></td></tr>
                                        <tr><td><code>gender</code></td><td>æ€§åˆ¥</td><td><code>male</code>ï¼ˆç”·æ€§ï¼‰/ <code>female</code>ï¼ˆå¥³æ€§ï¼‰/ <code>other</code>ï¼ˆãã®ä»–ï¼‰</td></tr>
                                        <tr><td><code>currentAddress</code></td><td>ç¾ä½æ‰€</td><td>ä¾‹: <em>æ±äº¬éƒ½æ¸‹è°·åŒº1-2-3</em></td></tr>
                                    </tbody>
                                </table>
                            </div>

                            <!-- ä½å±…ãƒ»è·æ¥­æƒ…å ± -->
                            <div class="guide-section">
                                <div class="guide-section-title" style="background:#f0fdf4; color:#166534; border-color:#bbf7d0;">
                                    ğŸ  ç¾åœ¨ã®ä½å±…ãƒ»è·æ¥­æƒ…å ±
                                </div>
                                <table class="guide-table">
                                    <thead><tr><th>åˆ—å</th><th>é …ç›®å</th><th>èª¬æ˜ãƒ»å…¥åŠ›ä¾‹</th></tr></thead>
                                    <tbody>
                                        <tr><td><code>currentHousing</code></td><td>ç¾åœ¨ã®ä½å±…å½¢æ…‹</td><td><em>è³ƒè²¸</em> / <em>å®Ÿå®¶</em> / <em>æŒã¡å®¶</em> / <em>ç¤¾å®…</em> ãªã©</td></tr>
                                        <tr><td><code>numberOfOccupants</code></td><td>å…¥å±…äººæ•°</td><td>æ•°å­—ã€‚ä¾‹: <em>2</em></td></tr>
                                        <tr><td><code>occupation</code></td><td>è·æ¥­</td><td><em>ä¼šç¤¾å“¡</em> / <em>è‡ªå–¶æ¥­</em> / <em>å­¦ç”Ÿ</em> / <em>ä¸»å©¦</em> ãªã©</td></tr>
                                        <tr><td><code>companyName</code></td><td>å‹¤å‹™å…ˆå</td><td>ä¾‹: <em>æ ªå¼ä¼šç¤¾ã‚µãƒ³ãƒ—ãƒ«</em></td></tr>
                                        <tr><td><code>yearsEmployed</code></td><td>å‹¤ç¶šå¹´æ•°</td><td>æ•°å­—ï¼ˆå¹´ï¼‰ã€‚ä¾‹: <em>5</em></td></tr>
                                        <tr><td><code>annualIncome</code></td><td>å¹´å</td><td>æ•°å­—ï¼ˆå††ï¼‰ã€‚ä¾‹: <em>5000000</em></td></tr>
                                        <tr><td><code>movingReason</code></td><td>å¼•è¶Šã—ç†ç”±</td><td><em>è»¢å‹¤</em> / <em>çµå©š</em> / <em>å°±è·</em> / <em>å®¶æ—æ§‹æˆã®å¤‰åŒ–</em> ãªã©</td></tr>
                                    </tbody>
                                </table>
                            </div>

                            <!-- å¸Œæœ›æ¡ä»¶ -->
                            <div class="guide-section">
                                <div class="guide-section-title" style="background:#fefce8; color:#854d0e; border-color:#fde68a;">
                                    ğŸ” å¸Œæœ›æ¡ä»¶
                                </div>
                                <table class="guide-table">
                                    <thead><tr><th>åˆ—å</th><th>é …ç›®å</th><th>èª¬æ˜ãƒ»å…¥åŠ›ä¾‹</th></tr></thead>
                                    <tbody>
                                        <tr><td><code>budgetMin</code></td><td>äºˆç®—ï¼ˆä¸‹é™ï¼‰</td><td>æ•°å­—ï¼ˆå††/æœˆï¼‰ã€‚ä¾‹: <em>80000</em></td></tr>
                                        <tr><td><code>budgetMax</code></td><td>äºˆç®—ï¼ˆä¸Šé™ï¼‰</td><td>æ•°å­—ï¼ˆå††/æœˆï¼‰ã€‚ä¾‹: <em>100000</em></td></tr>
                                        <tr><td><code>moveInDate</code></td><td>å¸Œæœ›å…¥å±…æ—¥</td><td>ä¾‹: <em>2026å¹´4æœˆ</em> / <em>å³å…¥å±…å¯</em></td></tr>
                                        <tr><td><code>areas</code></td><td>å¸Œæœ›ã‚¨ãƒªã‚¢</td><td>ä¾‹: <em>æ¸‹è°·é§…ãƒ»è¡¨å‚é“é§… å¾’æ­©10åˆ†ä»¥å†…</em></td></tr>
                                        <tr><td><code>layout</code></td><td>å¸Œæœ›é–“å–ã‚Š</td><td>è¤‡æ•°é¸æŠã¯ <code>|</code> åŒºåˆ‡ã‚Šã€‚ä¾‹: <em>1K|1DK|1LDK</em></td></tr>
                                        <tr><td><code>roomSize</code></td><td>å¸Œæœ›å°‚æœ‰é¢ç©ï¼ˆã¡ä»¥ä¸Šï¼‰</td><td>æ•°å­—ã€‚ä¾‹: <em>25</em></td></tr>
                                        <tr><td><code>stationWalk</code></td><td>é§…å¾’æ­©ï¼ˆåˆ†ä»¥å†…ï¼‰</td><td>æ•°å­—ã€‚ä¾‹: <em>10</em>ï¼ˆ<em>æŒ‡å®šãªã—</em> ã‚‚å¯ï¼‰</td></tr>
                                        <tr><td><code>floor</code></td><td>å¸Œæœ›éšæ•°</td><td>ä¾‹: <em>2éšä»¥ä¸Š</em> / <em>1éš</em> / <em>æŒ‡å®šãªã—</em></td></tr>
                                        <tr><td><code>buildingAge</code></td><td>ç¯‰å¹´æ•°</td><td>ä¾‹: <em>ç¯‰10å¹´ä»¥å†…</em> / <em>æ–°ç¯‰</em> / <em>æŒ‡å®šãªã—</em></td></tr>
                                    </tbody>
                                </table>
                            </div>

                            <!-- è¨­å‚™æ¡ä»¶ -->
                            <div class="guide-section">
                                <div class="guide-section-title" style="background:#fdf4ff; color:#6b21a8; border-color:#e9d5ff;">
                                    âš™ï¸ è¨­å‚™ãƒ»æ¡ä»¶ï¼ˆyes / no ã§å…¥åŠ›ï¼‰
                                </div>
                                <div style="font-size:12px; color:#6b7280; margin-bottom:10px;">ã™ã¹ã¦ <code>yes</code>ï¼ˆå¸Œæœ›ã™ã‚‹ï¼‰ã¾ãŸã¯ <code>no</code>ï¼ˆä¸å•ï¼‰ã§å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚ç©ºæ¬„ã¯ <code>no</code> ã¨ã—ã¦æ‰±ã‚ã‚Œã¾ã™ã€‚</div>
                                <table class="guide-table">
                                    <thead><tr><th>åˆ—å</th><th>é …ç›®å</th><th>åˆ—å</th><th>é …ç›®å</th></tr></thead>
                                    <tbody>
                                        <tr><td><code>separateBath</code></td><td>ãƒã‚¹ãƒ»ãƒˆã‚¤ãƒ¬åˆ¥</td><td><code>separateWashroom</code></td><td>æ´—é¢æ‰€ç‹¬ç«‹</td></tr>
                                        <tr><td><code>autoLock</code></td><td>ã‚ªãƒ¼ãƒˆãƒ­ãƒƒã‚¯</td><td><code>indoorWashing</code></td><td>å®¤å†…æ´—æ¿¯æ©Ÿç½®å ´</td></tr>
                                        <tr><td><code>deliveryBox</code></td><td>å®…é…ãƒœãƒƒã‚¯ã‚¹</td><td><code>elevator</code></td><td>ã‚¨ãƒ¬ãƒ™ãƒ¼ã‚¿ãƒ¼</td></tr>
                                        <tr><td><code>parking</code></td><td>é§è»Šå ´</td><td><code>bicycle</code></td><td>é§è¼ªå ´</td></tr>
                                        <tr><td><code>bike</code></td><td>ãƒã‚¤ã‚¯ç½®å ´</td><td><code>internet</code></td><td>ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆå®Œå‚™</td></tr>
                                        <tr><td><code>petAllowed</code></td><td>ãƒšãƒƒãƒˆå¯</td><td><code>instrumentAllowed</code></td><td>æ¥½å™¨å¯</td></tr>
                                        <tr><td><code>sohoAllowed</code></td><td>SOHOå¯</td><td><code>twoGasStove</code></td><td>2å£ä»¥ä¸Šã‚¬ã‚¹ã‚³ãƒ³ãƒ­</td></tr>
                                        <tr><td><code>noTatami</code></td><td>ç•³ãªã—</td><td><code>flooring</code></td><td>ãƒ•ãƒ­ãƒ¼ãƒªãƒ³ã‚°</td></tr>
                                    </tbody>
                                </table>
                            </div>

                            <!-- å¥‘ç´„æƒ…å ± -->
                            <div class="guide-section">
                                <div class="guide-section-title" style="background:#fff7ed; color:#9a3412; border-color:#fed7aa;">
                                    ğŸ“ å¥‘ç´„æƒ…å ±ï¼ˆæˆç´„å¾Œã«å…¥åŠ›ï¼‰
                                </div>
                                <table class="guide-table">
                                    <thead><tr><th>åˆ—å</th><th>é …ç›®å</th><th>èª¬æ˜ãƒ»å…¥åŠ›ä¾‹</th></tr></thead>
                                    <tbody>
                                        <tr><td><code>contractType</code></td><td>å¥‘ç´„ç¨®åˆ¥</td><td><em>æ–°è¦å¥‘ç´„</em> / <em>æ›´æ–°</em> / <em>å†å¥‘ç´„</em></td></tr>
                                        <tr><td><code>contractStartDate</code></td><td>å¥‘ç´„é–‹å§‹æ—¥</td><td>YYYY-MM-DDå½¢å¼ã€‚ä¾‹: <em>2026-04-01</em></td></tr>
                                        <tr><td><code>contractEndDate</code></td><td>å¥‘ç´„çµ‚äº†æ—¥</td><td>YYYY-MM-DDå½¢å¼ã€‚ä¾‹: <em>2028-03-31</em></td></tr>
                                        <tr><td><code>contractPeriodMonths</code></td><td>å¥‘ç´„æœŸé–“ï¼ˆæœˆæ•°ï¼‰</td><td>æ•°å­—ã€‚ä¾‹: <em>24</em></td></tr>
                                        <tr><td><code>monthlyRent</code></td><td>æœˆé¡è³ƒæ–™ï¼ˆå††ï¼‰</td><td>æ•°å­—ã€‚ä¾‹: <em>90000</em></td></tr>
                                        <tr><td><code>depositMonths</code></td><td>æ•·é‡‘ï¼ˆãƒ¶æœˆï¼‰</td><td>æ•°å­—ã€‚ä¾‹: <em>1</em></td></tr>
                                        <tr><td><code>keyMoneyMonths</code></td><td>ç¤¼é‡‘ï¼ˆãƒ¶æœˆï¼‰</td><td>æ•°å­—ã€‚ä¾‹: <em>1</em></td></tr>
                                        <tr><td><code>otherInitialCost</code></td><td>ãã®ä»–åˆæœŸè²»ç”¨ï¼ˆå††ï¼‰</td><td>æ•°å­—ã€‚ä¾‹: <em>50000</em></td></tr>
                                        <tr><td><code>contractPropertyAddress</code></td><td>å¥‘ç´„ç‰©ä»¶ä½æ‰€</td><td>ä¾‹: <em>æ±äº¬éƒ½æ¸‹è°·åŒºã€‡ã€‡1-2-3</em></td></tr>
                                        <tr><td><code>contractEndDateManual</code></td><td>å¥‘ç´„çµ‚äº†æ—¥ï¼ˆæ‰‹å‹•ï¼‰</td><td>è‡ªå‹•è¨ˆç®—ã¨ç•°ãªã‚‹å ´åˆã«å…¥åŠ›ã€‚YYYY-MM-DDå½¢å¼</td></tr>
                                    </tbody>
                                </table>
                            </div>

                            <!-- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ»ãƒ¡ãƒ¢ãƒ»ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ— -->
                            <div class="guide-section">
                                <div class="guide-section-title" style="background:#f0fdf4; color:#14532d; border-color:#bbf7d0;">
                                    ğŸ“Œ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ»ãƒ¡ãƒ¢ãƒ»ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—
                                </div>
                                <table class="guide-table">
                                    <thead><tr><th>åˆ—å</th><th>é …ç›®å</th><th>èª¬æ˜ãƒ»å…¥åŠ›ä¾‹</th></tr></thead>
                                    <tbody>
                                        <tr><td><code>pipelineStatus</code></td><td>ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</td><td><em>åˆå›ç›¸è«‡</em> / <em>ç‰©ä»¶ç´¹ä»‹</em> / <em>å†…è¦‹èª¿æ•´</em> / <em>ç”³è¾¼æº–å‚™</em> / <em>å¯©æŸ»ä¸­</em> / <em>å¥‘ç´„æ‰‹ç¶šã</em>ï¼ˆç©ºæ¬„ã¯ã€Œåˆå›ç›¸è«‡ã€ã«ãªã‚Šã¾ã™ï¼‰</td></tr>
                                        <tr><td><code>notes</code></td><td>é¡§å®¢ãƒ¡ãƒ¢</td><td>é¡§å®¢ã«è¦‹ã›ã‚‰ã‚Œã‚‹æƒ…å ±ã€‚ä¾‹: <em>äºˆç®—å†…ã§è‰¯ã„ç‰©ä»¶ã‚’æ¢ã—ãŸã„</em></td></tr>
                                        <tr><td><code>agentMemo</code></td><td>æ‹…å½“è€…ãƒ¡ãƒ¢</td><td>å†…éƒ¨ç”¨ãƒ¡ãƒ¢ã€‚ä¾‹: <em>çŒ«ã‚’é£¼ã£ã¦ã„ã‚‹</em></td></tr>
                                        <tr><td><code>desiredMoveInDate</code></td><td>å¸Œæœ›å…¥å±…æ—¥ï¼ˆæ—¥ä»˜å‹ï¼‰</td><td>YYYY-MM-DDå½¢å¼ã€‚ä¾‹: <em>2026-04-01</em></td></tr>
                                        <tr><td><code>applicationDate</code></td><td>ç”³è¾¼æ—¥</td><td>YYYY-MM-DDå½¢å¼</td></tr>
                                        <tr><td><code>followUpDate</code></td><td>ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—æ—¥</td><td>YYYY-MM-DDå½¢å¼</td></tr>
                                        <tr><td><code>additionalFollowUpDate</code></td><td>è¿½åŠ ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—æ—¥</td><td>YYYY-MM-DDå½¢å¼</td></tr>
                                        <tr><td><code>additionalFollowUpReminder</code></td><td>è¿½åŠ ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—ãƒ¡ãƒ¢</td><td>ä¾‹: <em>3ãƒ¶æœˆå¾Œã«å†ææ¡ˆ</em></td></tr>
                                    </tbody>
                                </table>
                            </div>

                            <div style="background:#fff; border:1px solid #e5e7eb; border-radius:8px; padding:14px; font-size:13px; color:#374151; margin-top:4px;">
                                ğŸ’¡ <strong>ãƒ’ãƒ³ãƒˆï¼š</strong>ç©ºæ¬„ã®é …ç›®ã¯ã‚¤ãƒ³ãƒãƒ¼ãƒˆå¾Œã«RentPipeä¸Šã§ç·¨é›†ã§ãã¾ã™ã€‚ã¾ãšã¯ <code>name</code>ãƒ»<code>phone</code> ã ã‘å…¥åŠ›ã—ãŸãƒ‡ãƒ¼ã‚¿ã§ã‚‚ã‚¤ãƒ³ãƒãƒ¼ãƒˆå¯èƒ½ã§ã™ã€‚
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- JSONã‚¤ãƒ³ãƒãƒ¼ãƒˆ -->
        <div id="json-import" class="import-section" style="display: none;">
            <div class="card-rentpipe">
                <h2 style="font-size: 18px; margin-bottom: 16px;">ğŸ“¦ JSONãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</h2>

                <!-- ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚¨ãƒªã‚¢ -->
                <div class="upload-area" id="json-upload-area">
                    <input type="file" id="json-file-input" accept=".json" style="display: none;" onchange="handleJsonFile(event)">
                    <label for="json-file-input" class="upload-label">
                        <div class="upload-icon">ğŸ“</div>
                        <p class="upload-text">ã‚¯ãƒªãƒƒã‚¯ã—ã¦JSONãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ</p>
                        <p class="upload-hint">ã¾ãŸã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—</p>
                    </label>
                </div>

                <!-- JSONãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆä¾‹ -->
                <div class="mt-4" style="margin-top: 24px;">
                    <h3 style="font-size: 16px; margin-bottom: 12px;">ğŸ“ JSONãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ</h3>
                    <p style="font-size: 14px; color: #6b7280; margin-bottom: 12px;">
                        RentPipeã®å…¨é …ç›®ã«å¯¾å¿œã—ãŸè©³ç´°ãªãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã§ã™ã€‚<br>
                        å¿…é ˆé …ç›®ã¯ã€Œnameï¼ˆãŠåå‰ï¼‰ã€ã¨ã€Œphoneï¼ˆé›»è©±ç•ªå·ï¼‰ã€ã®ã¿ã§ã™ã€‚ãã®ä»–ã¯ç©ºæ–‡å­—åˆ—ï¼ˆ""ï¼‰ã§ã‚‚æ§‹ã„ã¾ã›ã‚“ã€‚
                    </p>
                    <pre class="code-block">[
  {
    "name": "å±±ç”°å¤ªéƒ",
    "nameKana": "ãƒ¤ãƒãƒ€ã‚¿ãƒ­ã‚¦",
    "email": "yamada@example.com",
    "phone": "090-1234-5678",
    "birthday": "1990-01-15",
    "gender": "male",
    "currentAddress": "æ±äº¬éƒ½æ¸‹è°·åŒº1-2-3",
    "budgetMin": "80000",
    "budgetMax": "100000",
    "areas": "æ¸‹è°·é§…ãƒ»è¡¨å‚é“é§… å¾’æ­©10åˆ†ä»¥å†…",
    "layout": "1K|1DK",
    "pipelineStatus": "åˆå›ç›¸è«‡",
    "notes": "äºˆç®—å†…ã§è‰¯ã„ç‰©ä»¶ã‚’æ¢ã—ãŸã„",
    ...ï¼ˆå…¨60é …ç›®ï¼‰
  }
]</pre>
                    <div class="flex gap-3 flex-wrap mt-2" style="display:flex; gap:10px; flex-wrap:wrap; margin-top:10px;">
                        <button class="btn-rentpipe btn-rentpipe-primary" onclick="downloadJsonTemplate()">
                            â¬‡ï¸ è©³ç´°ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
                        </button>
                        <button class="btn-rentpipe" onclick="selectFormat('csv'); setTimeout(()=>{toggleFieldGuide(true);document.getElementById('field-guide').scrollIntoView({behavior:'smooth'})},100);" style="border:2px solid #3d4e6b; color:#3d4e6b; background:white;">
                            ğŸ“– é …ç›®ã‚¬ã‚¤ãƒ‰ã‚’è¦‹ã‚‹ï¼ˆCSVç‰ˆï¼‰
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚¨ãƒªã‚¢ -->
        <div id="preview-section" class="card-rentpipe" style="display: none; margin-top: 24px;">
            <h2 style="font-size: 18px; margin-bottom: 16px;">ğŸ‘ï¸ ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</h2>
            <div id="preview-stats" class="mb-3" style="margin-bottom: 16px;"></div>
            <div id="preview-table-container" style="overflow-x: auto;"></div>
            <div class="mt-4" style="margin-top: 24px; display: flex; gap: 12px;">
                <button class="btn-rentpipe btn-rentpipe-success" onclick="executeImport()">
                    âœ… ã‚¤ãƒ³ãƒãƒ¼ãƒˆå®Ÿè¡Œ
                </button>
                <button class="btn-rentpipe btn-rentpipe-danger" onclick="cancelImport()">
                    âŒ ã‚­ãƒ£ãƒ³ã‚»ãƒ«
                </button>
            </div>
        </div>

        <!-- çµæœè¡¨ç¤ºã‚¨ãƒªã‚¢ -->
        <div id="result-section" class="card-rentpipe" style="display: none; margin-top: 24px;">
            <div id="result-content"></div>
        </div>
    </div>

    <!-- Google API Client & Identity Services -->
    <script src="https://accounts.google.com/gsi/client"></script>
    <script src="https://apis.google.com/js/api.js"></script>

    <!-- RentPipe Core Scripts -->
    <script src="js/config.js"></script>
    <script src="js/session-manager.js"></script>
    <script src="js/notification-manager.js"></script>
    <script src="js/navigation.js"></script>
    <script src="js/integrated-auth-manager-v2.js"></script>
    <script src="js/google-drive-api-v2.js"></script>
    <script src="js/google-sheets-api.js"></script>
    <script src="js/data-migration.js"></script>
    <script src="js/unified-sheets-manager.js"></script>
    <script src="js/unified-data-manager.js"></script>
    <script src="js/app-initializer.js"></script>
    <script src="js/page-initializer.js"></script>

    <script>
        let importData = [];
        let currentFormat = 'csv';

        document.addEventListener('DOMContentLoaded', async function() {
            loadNavigation();
            if (window.NotificationManager) NotificationManager.init();
            setupDragAndDrop();

            // èªè¨¼ãƒ»ãƒ‡ãƒ¼ã‚¿åˆæœŸåŒ–ï¼ˆUnifiedDataManager ã‚’ä½¿ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹ï¼‰
            if (window.AppInitializer) {
                try {
                    await AppInitializer.initialize({ silent: true });
                } catch (e) {
                    console.warn('AppInitializer ã‚¨ãƒ©ãƒ¼ï¼ˆã‚¤ãƒ³ãƒãƒ¼ãƒˆã¯ç¶šè¡Œå¯èƒ½ï¼‰:', e.message);
                }
            }
        });

        function selectFormat(format) {
            currentFormat = format;

            // ãƒœã‚¿ãƒ³ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ–çŠ¶æ…‹ã‚’åˆ‡ã‚Šæ›¿ãˆ
            document.querySelectorAll('[data-format]').forEach(btn => {
                btn.classList.toggle('active', btn.getAttribute('data-format') === format);
            });

            // ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®è¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆ
            document.getElementById('csv-import').style.display = format === 'csv' ? 'block' : 'none';
            document.getElementById('json-import').style.display = format === 'json' ? 'block' : 'none';

            // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ»çµæœã‚’ã‚¯ãƒªã‚¢
            hidePreview();
            hideResult();
        }

        function toggleFieldGuide(forceOpen) {
            const guide = document.getElementById('field-guide');
            const btn = document.getElementById('guide-toggle-btn');
            const isHidden = guide.style.display === 'none';
            const show = forceOpen !== undefined ? forceOpen : isHidden;

            guide.style.display = show ? 'block' : 'none';
            if (btn) {
                btn.textContent = show ? 'ğŸ“– é …ç›®ã‚¬ã‚¤ãƒ‰ã‚’é–‰ã˜ã‚‹' : 'ğŸ“– é …ç›®ã‚¬ã‚¤ãƒ‰ã‚’è¦‹ã‚‹';
            }

            if (show) {
                setTimeout(() => guide.scrollIntoView({ behavior: 'smooth', block: 'start' }), 50);
            }
        }

        function setupDragAndDrop() {
            ['csv-upload-area', 'json-upload-area'].forEach(areaId => {
                const area = document.getElementById(areaId);
                if (!area) return;

                area.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    area.classList.add('dragover');
                });

                area.addEventListener('dragleave', () => {
                    area.classList.remove('dragover');
                });

                area.addEventListener('drop', (e) => {
                    e.preventDefault();
                    area.classList.remove('dragover');

                    const files = e.dataTransfer.files;
                    if (files.length > 0) {
                        const file = files[0];
                        if (areaId === 'csv-upload-area' && file.name.endsWith('.csv')) {
                            handleCsvFile({ target: { files: [file] } });
                        } else if (areaId === 'json-upload-area' && file.name.endsWith('.json')) {
                            handleJsonFile({ target: { files: [file] } });
                        }
                    }
                });
            });
        }

        function handleCsvFile(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const csv = e.target.result;
                    importData = parseCsv(csv);
                    showPreview();
                } catch (error) {
                    alert('CSVãƒ•ã‚¡ã‚¤ãƒ«ã®è§£æã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message);
                }
            };
            reader.readAsText(file);
        }

        function handleJsonFile(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    importData = JSON.parse(e.target.result);
                    if (!Array.isArray(importData)) {
                        throw new Error('JSONé…åˆ—ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™');
                    }
                    showPreview();
                } catch (error) {
                    alert('JSONãƒ•ã‚¡ã‚¤ãƒ«ã®è§£æã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message);
                }
            };
            reader.readAsText(file);
        }

        function parseCsv(csv) {
            const lines = csv.trim().split('\n');
            if (lines.length < 2) {
                throw new Error('CSVãƒ‡ãƒ¼ã‚¿ãŒä¸æ­£ã§ã™');
            }

            const headers = lines[0].split(',').map(h => h.trim());
            const data = [];

            for (let i = 1; i < lines.length; i++) {
                const values = lines[i].split(',').map(v => v.trim());
                const row = {};
                headers.forEach((header, index) => {
                    row[header] = values[index] || '';
                });
                data.push(row);
            }

            return data;
        }

        function showPreview() {
            const previewSection = document.getElementById('preview-section');
            const statsDiv = document.getElementById('preview-stats');
            const tableContainer = document.getElementById('preview-table-container');

            // çµ±è¨ˆæƒ…å ±
            statsDiv.innerHTML = `
                <div class="badge-rentpipe-info">
                    ğŸ“Š ${importData.length}ä»¶ã®ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸ
                </div>
            `;

            // ãƒ†ãƒ¼ãƒ–ãƒ«ç”Ÿæˆ
            if (importData.length > 0) {
                const headers = Object.keys(importData[0]);
                let tableHtml = '<table class="preview-table"><thead><tr>';
                headers.forEach(header => {
                    tableHtml += `<th>${header}</th>`;
                });
                tableHtml += '</tr></thead><tbody>';

                importData.slice(0, 10).forEach(row => {
                    tableHtml += '<tr>';
                    headers.forEach(header => {
                        tableHtml += `<td>${row[header] || ''}</td>`;
                    });
                    tableHtml += '</tr>';
                });

                if (importData.length > 10) {
                    tableHtml += `<tr><td colspan="${headers.length}" class="text-muted" style="text-align: center;">... ä»– ${importData.length - 10} ä»¶</td></tr>`;
                }

                tableHtml += '</tbody></table>';
                tableContainer.innerHTML = tableHtml;
            }

            previewSection.style.display = 'block';
            hideResult();
        }

        function hidePreview() {
            document.getElementById('preview-section').style.display = 'none';
        }

        function hideResult() {
            document.getElementById('result-section').style.display = 'none';
        }

        /**
         * CSVãƒ•ãƒ©ãƒƒãƒˆè¡Œ â†’ UnifiedDataManager.addCustomer() ãŒæœŸå¾…ã™ã‚‹ãƒã‚¹ãƒˆæ§‹é€ ã«å¤‰æ›
         */
        function mapRowToCustomer(row) {
            const yn = v => v === 'yes'; // yes/no â†’ boolean
            const num = v => v ? Number(v) || 0 : 0;

            return {
                basicInfo: {
                    name:               row.name              || '',
                    nameKana:           row.nameKana          || '',
                    email:              row.email             || '',
                    phone:              row.phone             || '',
                    birthday:           row.birthday          || '',
                    gender:             row.gender            || 'no_answer',
                    currentAddress:     row.currentAddress    || '',
                    currentHousing:     row.currentHousing    || '',
                    occupation:         row.occupation        || '',
                    companyName:        row.companyName       || '',
                    yearsEmployed:      num(row.yearsEmployed),
                    annualIncome:       num(row.annualIncome),
                    movingReason:       row.movingReason      || '',
                    numberOfOccupants:  num(row.numberOfOccupants) || 1,
                },
                preferences: {
                    budget: {
                        min:  num(row.budgetMin),
                        max:  num(row.budgetMax),
                        note: '',
                    },
                    moveInDate:     row.moveInDate    || '',
                    areas:          row.areas         || '',
                    layout:         row.layout        || '',
                    roomSize:       num(row.roomSize),
                    stationWalk:    row.stationWalk   || '',
                    floor:          row.floor         || '',
                    buildingAge:    row.buildingAge   || '',
                    facilities: {
                        separateBath:       yn(row.separateBath),
                        separateWashroom:   yn(row.separateWashroom),
                        autoLock:           yn(row.autoLock),
                        indoorWashing:      yn(row.indoorWashing),
                        deliveryBox:        yn(row.deliveryBox),
                        elevator:           yn(row.elevator),
                        parking:            yn(row.parking),
                        bicycle:            yn(row.bicycle),
                        bike:               yn(row.bike),
                        internet:           yn(row.internet),
                        petAllowed:         yn(row.petAllowed),
                        instrumentAllowed:  yn(row.instrumentAllowed),
                        sohoAllowed:        yn(row.sohoAllowed),
                        twoGasStove:        yn(row.twoGasStove),
                        noTatami:           yn(row.noTatami),
                        flooring:           yn(row.flooring),
                    },
                },
                contract: {
                    contractType:            row.contractType            || '',
                    contractStartDate:       row.contractStartDate       || '',
                    contractEndDate:         row.contractEndDate         || '',
                    contractPeriodMonths:    num(row.contractPeriodMonths),
                    monthlyRent:             num(row.monthlyRent),
                    depositMonths:           num(row.depositMonths),
                    keyMoneyMonths:          num(row.keyMoneyMonths),
                    otherInitialCost:        num(row.otherInitialCost),
                    contractPropertyAddress: row.contractPropertyAddress || '',
                    contractEndDateManual:   row.contractEndDateManual   || '',
                },
                pipelineStatus: row.pipelineStatus || 'åˆå›ç›¸è«‡',
                notes:          row.notes          || '',
                agentMemo:      row.agentMemo       || '',
                followUp: {
                    desiredMoveInDate:        row.desiredMoveInDate        || '',
                    applicationDate:          row.applicationDate          || '',
                    followUpDate:             row.followUpDate             || '',
                    additionalFollowUpDate:   row.additionalFollowUpDate   || '',
                    additionalFollowUpReminder: row.additionalFollowUpReminder || '',
                },
                isActive: true,
            };
        }

        async function executeImport() {
            if (importData.length === 0) {
                alert('ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“');
                return;
            }

            // UnifiedDataManager ã®å­˜åœ¨ç¢ºèª
            if (!window.UnifiedDataManager) {
                alert('ãƒ‡ãƒ¼ã‚¿ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ãŒèª­ã¿è¾¼ã¾ã‚Œã¦ã„ã¾ã›ã‚“ã€‚ãƒšãƒ¼ã‚¸ã‚’ãƒªãƒ­ãƒ¼ãƒ‰ã—ã¦ãã ã•ã„ã€‚');
                return;
            }

            const resultSection = document.getElementById('result-section');
            const resultContent = document.getElementById('result-content');

            let successCount = 0;
            let errorCount = 0;
            const errors = [];

            // é€²æ—è¡¨ç¤º
            resultContent.innerHTML = `
                <div class="text-center">
                    <div class="spinner"></div>
                    <p>ã‚¤ãƒ³ãƒãƒ¼ãƒˆä¸­... (0 / ${importData.length})</p>
                </div>
            `;
            resultSection.style.display = 'block';

            // 1ä»¶ãšã¤ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
            for (let i = 0; i < importData.length; i++) {
                try {
                    const row = importData[i];

                    // å¿…é ˆé …ç›®ãƒã‚§ãƒƒã‚¯
                    if (!row.name || !row.phone) {
                        throw new Error('nameï¼ˆæ°åï¼‰ã¾ãŸã¯phoneï¼ˆé›»è©±ç•ªå·ï¼‰ãŒç©ºã§ã™');
                    }

                    const customerData = mapRowToCustomer(row);
                    await window.UnifiedDataManager.addCustomer(customerData);
                    successCount++;

                } catch (error) {
                    errorCount++;
                    errors.push(`è¡Œ${i + 2}: ${error.message}`); // ãƒ˜ãƒƒãƒ€è¡Œã‚’è€ƒæ…®ã—ã¦+2
                }

                // é€²æ—æ›´æ–°
                resultContent.innerHTML = `
                    <div class="text-center">
                        <div class="spinner"></div>
                        <p>ã‚¤ãƒ³ãƒãƒ¼ãƒˆä¸­... (${i + 1} / ${importData.length})</p>
                    </div>
                `;
            }

            // å®Œäº†å¾Œ Google Sheets ã¸åŒæœŸ
            if (successCount > 0 && window.UnifiedDataManager) {
                try {
                    await window.UnifiedDataManager.syncToSheetsImmediately?.();
                } catch (e) {
                    console.warn('SheetsåŒæœŸã‚¹ã‚­ãƒƒãƒ—:', e.message);
                }
            }

            // çµæœè¡¨ç¤º
            resultContent.innerHTML = `
                <h2 style="font-size: 18px; margin-bottom: 16px;">âœ… ã‚¤ãƒ³ãƒãƒ¼ãƒˆå®Œäº†</h2>
                <div class="mb-3">
                    <div class="badge-rentpipe-success" style="margin-right: 8px;">
                        æˆåŠŸ: ${successCount}ä»¶
                    </div>
                    ${errorCount > 0 ? `<div class="badge-rentpipe-danger">å¤±æ•—: ${errorCount}ä»¶</div>` : ''}
                </div>
                ${errorCount > 0 ? `
                    <div class="mt-3">
                        <h3 style="font-size: 16px; margin-bottom: 8px;">âŒ ã‚¨ãƒ©ãƒ¼è©³ç´°</h3>
                        <pre class="code-block" style="max-height: 200px; overflow-y: auto;">${errors.join('\n')}</pre>
                    </div>
                ` : ''}
                <div class="mt-4">
                    <a href="customer.html" class="btn-rentpipe btn-rentpipe-primary">
                        ğŸ“‹ é¡§å®¢ä¸€è¦§ã¸æˆ»ã‚‹
                    </a>
                    <button class="btn-rentpipe" onclick="resetImport()" style="margin-left: 8px;">
                        ğŸ”„ æ–°ã—ã„ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
                    </button>
                </div>
            `;

            hidePreview();
        }

        function cancelImport() {
            if (confirm('ã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã—ã¾ã™ã‹ï¼Ÿ')) {
                resetImport();
            }
        }

        function resetImport() {
            importData = [];
            document.getElementById('csv-file-input').value = '';
            document.getElementById('json-file-input').value = '';
            hidePreview();
            hideResult();
        }

        function downloadCsvTemplate() {
            // RentPipe é¡§å®¢æƒ…å ± è©³ç´°ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆï¼ˆå…¨60é …ç›®ï¼‰
            const csv = `name,nameKana,email,phone,birthday,gender,currentAddress,currentHousing,numberOfOccupants,occupation,companyName,yearsEmployed,annualIncome,movingReason,budgetMin,budgetMax,moveInDate,areas,layout,roomSize,stationWalk,floor,buildingAge,separateBath,separateWashroom,autoLock,indoorWashing,deliveryBox,elevator,parking,bicycle,bike,internet,petAllowed,instrumentAllowed,sohoAllowed,twoGasStove,noTatami,flooring,contractType,contractStartDate,contractEndDate,contractPeriodMonths,monthlyRent,depositMonths,keyMoneyMonths,otherInitialCost,contractPropertyAddress,pipelineStatus,notes,agentMemo,desiredMoveInDate,applicationDate,followUpDate,additionalFollowUpDate,additionalFollowUpReminder,contractEndDateManual
å±±ç”°å¤ªéƒ,ãƒ¤ãƒãƒ€ã‚¿ãƒ­ã‚¦,yamada@example.com,090-1234-5678,1990-01-15,male,æ±äº¬éƒ½æ¸‹è°·åŒº1-2-3,è³ƒè²¸,1,ä¼šç¤¾å“¡,æ ªå¼ä¼šç¤¾ã‚µãƒ³ãƒ—ãƒ«,5,5000000,è»¢å‹¤,80000,100000,2026å¹´4æœˆ,æ¸‹è°·é§…ãƒ»è¡¨å‚é“é§… å¾’æ­©10åˆ†ä»¥å†…,1K|1DK,25,10,2éšä»¥ä¸Š,ç¯‰10å¹´ä»¥å†…,yes,yes,yes,yes,yes,yes,no,no,no,yes,no,no,no,yes,yes,yes,æ–°è¦å¥‘ç´„,2026-04-01,2028-03-31,24,90000,1,1,50000,æ±äº¬éƒ½æ¸‹è°·åŒºã‚µãƒ³ãƒ—ãƒ«ç”º1-2-3,åˆå›ç›¸è«‡,äºˆç®—å†…ã§è‰¯ã„ç‰©ä»¶ã‚’æ¢ã—ãŸã„,ç©æ¥µçš„ã«ç‰©ä»¶ç´¹ä»‹,2026-04-01,,,,,
ä½è—¤èŠ±å­,ã‚µãƒˆã‚¦ãƒãƒŠã‚³,sato@example.com,080-9876-5432,1995-05-20,female,ç¥å¥ˆå·çœŒæ¨ªæµœå¸‚ä¸­åŒº4-5-6,å®Ÿå®¶,2,è‡ªå–¶æ¥­,ä½è—¤ä¸å‹•ç”£,,3000000,çµå©š,60000,80000,2026å¹´5æœˆ,æ¨ªæµœé§…ãƒ»ã¿ãªã¨ã¿ã‚‰ã„é§…,1LDK|2K,30,15,æŒ‡å®šãªã—,æŒ‡å®šãªã—,yes,yes,yes,no,yes,no,no,no,no,yes,yes,no,no,no,no,no,,,,,,,,,ç‰©ä»¶ç´¹ä»‹,ãƒšãƒƒãƒˆå¯ã®ç‰©ä»¶å¸Œæœ›,çŒ«ã‚’é£¼ã£ã¦ã„ã‚‹,2026-05-01,,,,,`;

            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'rentpipe_customer_template_detailed.csv';
            link.click();
        }

        function downloadJsonTemplate() {
            const json = JSON.stringify([
                {
                    // åŸºæœ¬æƒ…å ±ï¼ˆå¿…é ˆé …ç›®: name, phoneï¼‰
                    name: 'å±±ç”°å¤ªéƒ',
                    nameKana: 'ãƒ¤ãƒãƒ€ã‚¿ãƒ­ã‚¦',
                    email: 'yamada@example.com',
                    phone: '090-1234-5678',
                    birthday: '1990-01-15',
                    gender: 'male',
                    currentAddress: 'æ±äº¬éƒ½æ¸‹è°·åŒº1-2-3',

                    // ä½å±…ãƒ»è·æ¥­æƒ…å ±
                    currentHousing: 'è³ƒè²¸',
                    numberOfOccupants: '1',
                    occupation: 'ä¼šç¤¾å“¡',
                    companyName: 'æ ªå¼ä¼šç¤¾ã‚µãƒ³ãƒ—ãƒ«',
                    yearsEmployed: '5',
                    annualIncome: '5000000',
                    movingReason: 'è»¢å‹¤',

                    // å¸Œæœ›æ¡ä»¶
                    budgetMin: '80000',
                    budgetMax: '100000',
                    moveInDate: '2026å¹´4æœˆ',
                    areas: 'æ¸‹è°·é§…ãƒ»è¡¨å‚é“é§… å¾’æ­©10åˆ†ä»¥å†…',
                    layout: '1K|1DK',
                    roomSize: '25',
                    stationWalk: '10',
                    floor: '2éšä»¥ä¸Š',
                    buildingAge: 'ç¯‰10å¹´ä»¥å†…',

                    // è¨­å‚™æ¡ä»¶ï¼ˆyes/noï¼‰
                    separateBath: 'yes',
                    separateWashroom: 'yes',
                    autoLock: 'yes',
                    indoorWashing: 'yes',
                    deliveryBox: 'yes',
                    elevator: 'yes',
                    parking: 'no',
                    bicycle: 'no',
                    bike: 'no',
                    internet: 'yes',
                    petAllowed: 'no',
                    instrumentAllowed: 'no',
                    sohoAllowed: 'no',
                    twoGasStove: 'yes',
                    noTatami: 'yes',
                    flooring: 'yes',

                    // å¥‘ç´„æƒ…å ±
                    contractType: 'æ–°è¦å¥‘ç´„',
                    contractStartDate: '2026-04-01',
                    contractEndDate: '2028-03-31',
                    contractPeriodMonths: '24',
                    monthlyRent: '90000',
                    depositMonths: '1',
                    keyMoneyMonths: '1',
                    otherInitialCost: '50000',
                    contractPropertyAddress: 'æ±äº¬éƒ½æ¸‹è°·åŒºã‚µãƒ³ãƒ—ãƒ«ç”º1-2-3',

                    // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ»ãƒ¡ãƒ¢
                    pipelineStatus: 'åˆå›ç›¸è«‡',
                    notes: 'äºˆç®—å†…ã§è‰¯ã„ç‰©ä»¶ã‚’æ¢ã—ãŸã„',
                    agentMemo: 'ç©æ¥µçš„ã«ç‰©ä»¶ç´¹ä»‹',

                    // ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—
                    desiredMoveInDate: '2026-04-01',
                    applicationDate: '',
                    followUpDate: '',
                    additionalFollowUpDate: '',
                    additionalFollowUpReminder: '',
                    contractEndDateManual: ''
                },
                {
                    // æœ€å°é™ã®ä¾‹ï¼ˆå¿…é ˆé …ç›®ã®ã¿ï¼‰
                    name: 'ä½è—¤èŠ±å­',
                    nameKana: 'ã‚µãƒˆã‚¦ãƒãƒŠã‚³',
                    email: 'sato@example.com',
                    phone: '080-9876-5432',
                    birthday: '1995-05-20',
                    gender: 'female',
                    currentAddress: 'ç¥å¥ˆå·çœŒæ¨ªæµœå¸‚ä¸­åŒº4-5-6',
                    currentHousing: 'å®Ÿå®¶',
                    numberOfOccupants: '2',
                    occupation: 'è‡ªå–¶æ¥­',
                    companyName: 'ä½è—¤ä¸å‹•ç”£',
                    yearsEmployed: '',
                    annualIncome: '3000000',
                    movingReason: 'çµå©š',
                    budgetMin: '60000',
                    budgetMax: '80000',
                    moveInDate: '2026å¹´5æœˆ',
                    areas: 'æ¨ªæµœé§…ãƒ»ã¿ãªã¨ã¿ã‚‰ã„é§…',
                    layout: '1LDK|2K',
                    roomSize: '30',
                    stationWalk: '15',
                    floor: 'æŒ‡å®šãªã—',
                    buildingAge: 'æŒ‡å®šãªã—',
                    separateBath: 'yes',
                    separateWashroom: 'yes',
                    autoLock: 'yes',
                    indoorWashing: 'no',
                    deliveryBox: 'yes',
                    elevator: 'no',
                    parking: 'no',
                    bicycle: 'no',
                    bike: 'no',
                    internet: 'yes',
                    petAllowed: 'yes',
                    instrumentAllowed: 'no',
                    sohoAllowed: 'no',
                    twoGasStove: 'no',
                    noTatami: 'no',
                    flooring: 'no',
                    contractType: '',
                    contractStartDate: '',
                    contractEndDate: '',
                    contractPeriodMonths: '',
                    monthlyRent: '',
                    depositMonths: '',
                    keyMoneyMonths: '',
                    otherInitialCost: '',
                    contractPropertyAddress: '',
                    pipelineStatus: 'ç‰©ä»¶ç´¹ä»‹',
                    notes: 'ãƒšãƒƒãƒˆå¯ã®ç‰©ä»¶å¸Œæœ›',
                    agentMemo: 'çŒ«ã‚’é£¼ã£ã¦ã„ã‚‹',
                    desiredMoveInDate: '2026-05-01',
                    applicationDate: '',
                    followUpDate: '',
                    additionalFollowUpDate: '',
                    additionalFollowUpReminder: '',
                    contractEndDateManual: ''
                }
            ], null, 2);

            const blob = new Blob([json], { type: 'application/json;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'rentpipe_customer_template_detailed.json';
            link.click();
        }
    </script>

    <style>
        .upload-area {
            border: 2px dashed #cbd5e1;
            border-radius: 8px;
            padding: 40px;
            text-align: center;
            transition: all 0.2s;
            cursor: pointer;
        }

        .upload-area:hover, .upload-area.dragover {
            border-color: #3d4e6b;
            background: #f8f9ff;
        }

        .upload-label {
            cursor: pointer;
            display: block;
        }

        .upload-icon {
            font-size: 48px;
            margin-bottom: 16px;
        }

        .upload-text {
            font-size: 16px;
            font-weight: 600;
            color: #1f2937;
            margin: 0 0 8px 0;
        }

        .upload-hint {
            font-size: 14px;
            color: #6b7280;
            margin: 0;
        }

        .code-block {
            background: #1f2937;
            color: #f3f4f6;
            padding: 16px;
            border-radius: 6px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            line-height: 1.6;
        }

        .preview-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }

        .preview-table th, .preview-table td {
            border: 1px solid #e5e7eb;
            padding: 12px;
            text-align: left;
        }

        .preview-table th {
            background: #f9fafb;
            font-weight: 600;
            color: #1f2937;
        }

        .preview-table tr:hover {
            background: #f9fafb;
        }

        .spinner {
            border: 4px solid #f3f4f6;
            border-top: 4px solid #3d4e6b;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 16px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .mb-3 {
            margin-bottom: 16px;
        }

        .mb-4 {
            margin-bottom: 24px;
        }

        .mt-2 {
            margin-top: 8px;
        }

        .mt-3 {
            margin-top: 16px;
        }

        .mt-4 {
            margin-top: 24px;
        }

        .text-center {
            text-align: center;
        }

        /* é …ç›®ã‚¬ã‚¤ãƒ‰ */
        .guide-section {
            margin-bottom: 16px;
        }
        .guide-section-title {
            font-size: 13px;
            font-weight: 700;
            padding: 7px 12px;
            border-radius: 6px;
            border: 1px solid;
            margin-bottom: 8px;
        }
        .guide-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 12.5px;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0,0,0,0.07);
        }
        .guide-table th {
            background: #f8fafc;
            color: #374151;
            font-weight: 600;
            padding: 8px 12px;
            text-align: left;
            border-bottom: 1px solid #e5e7eb;
        }
        .guide-table td {
            padding: 7px 12px;
            border-bottom: 1px solid #f3f4f6;
            color: #4b5563;
            line-height: 1.5;
        }
        .guide-table tr:last-child td {
            border-bottom: none;
        }
        .guide-table tr:hover td {
            background: #f9fafb;
        }
        .guide-table code {
            background: #e0e7ff;
            color: #3730a3;
            padding: 1px 5px;
            border-radius: 4px;
            font-size: 11.5px;
            font-family: 'Courier New', monospace;
        }
        .guide-table em {
            color: #059669;
            font-style: normal;
        }
    </style>
</body>
</html>
